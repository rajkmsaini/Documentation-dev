<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UFT-8"/>
<title> OpenFOAM&reg; Programmer's C++ documentation </title>
<!-- links -->
<link href="../OpenFOAMdocIcon.png" rel="icon" type="image/png" />
<link href="search/search.css" rel="stylesheet" type="text/css" />
<link href="../css/openfoam.css" rel="stylesheet" type="text/css" />
<script type="text/javaScript" src="search/search.js"></script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- meta info -->
<meta
    name="keywords"
    content="computational fluid dynamics, CFD, OpenFOAM, open source CFD, open source"
    />
</head>
<body>
<div class="page-container">
  <div class="header">
    <div class="header-top">
      <a class="sitelogo" href="http://www.openfoam.org" title="Home">
        <img class=left src="../css/img/OpenFOAMlogo.png">
      </a>
      <div class="sitename">
        <h1>
          <a href="http://foam.sourceforge.net/doc/Doxygen/html/"
             title="Source Guide">OpenFOAM C++ Documentation
          </a>
        </h1>
      </div>
    </div>  <!-- header-top -->
  </div>  <!-- header -->
  <div class="main">
    <div>
    <!-- begin of doxygen-generated content -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_ae30ad0bef50cf391b24c614251bb9fd.html">meshTools</a></li><li class="navelem"><a class="el" href="dir_2c4b96702ead4056d900947b6784ec65.html">triSurface</a></li><li class="navelem"><a class="el" href="dir_c7ea400be066a7991c819dfdcc67c0c6.html">surfaceFeatures</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">surfaceFeatures.C</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a07500.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*---------------------------------------------------------------------------*\</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">  =========                 |</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">   \\    /   O peration     |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    \\  /    A nd           | Copyright (C) 2011-2015 OpenFOAM Foundation</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">     \\/     M anipulation  |</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">-------------------------------------------------------------------------------</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">License</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">    This file is part of OpenFOAM.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">    OpenFOAM is free software: you can redistribute it and/or modify it</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">    under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">    the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">    (at your option) any later version.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">    OpenFOAM is distributed in the hope that it will be useful, but WITHOUT</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">    FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">    for more details.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">    You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">    along with OpenFOAM.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">\*---------------------------------------------------------------------------*/</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07501.html">surfaceFeatures.H</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a10506.html">triSurface.H</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07557.html">indexedOctree.H</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07277.html">treeDataEdge.H</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07281.html">treeDataPoint.H</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07317.html">meshTools.H</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a08776.html">linePointRef.H</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07785.html">OFstream.H</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07783.html">IFstream.H</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a08195.html">unitConversion.H</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a08540.html">EdgeMap.H</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// * * * * * * * * * * * * * * Static Data Members * * * * * * * * * * * * * //</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">namespace </span><a class="code" href="a10742.html">Foam</a></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<a class="code" href="a10742.html#a9907f9d4272b10c75ac87c1679b77c24">defineTypeNameAndDebug</a>(surfaceFeatures, 0);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">const</span> scalar surfaceFeatures::parallelTolerance = <a class="code" href="a10742.html#a4517d680df5510934705011b30dcefa6">sin</a>(<a class="code" href="a10742.html#af706f965be4d1457b0f1e7fade1c0118">degToRad</a>(1.0));</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// * * * * * * * * * * * * * Private Member Functions  * * * * * * * * * * * //</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//- Get nearest point on edge and classify position on edge.</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<a class="code" href="a01890.html">Foam::pointIndexHit</a> Foam::surfaceFeatures::edgeNearest</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;(</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a643590f4015338d12714af03d61a0ac9">point</a>&amp; start,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a643590f4015338d12714af03d61a0ac9">point</a>&amp; end,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a643590f4015338d12714af03d61a0ac9">point</a>&amp; sample</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="a10742.html#aa37b155edbb26030ea38158b7483b0ba">pointHit</a> eHit = <a class="code" href="a10742.html#a2e0318a3a140a9ee64174b45fbfd45f0">linePointRef</a>(start, end).nearestDist(sample);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// Classification of position on edge.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> endPoint;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (eHit.hit())</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment">// Nearest point is on edge itself.</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// Note: might be at or very close to endpoint. We should use tolerance</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="comment">// here.</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        endPoint = -1;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="comment">// Nearest point has to be one of the end points. Find out</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="comment">// which one.</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        (</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(eHit.rawPoint() - start)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;          &lt; <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(eHit.rawPoint() - end)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        )</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            endPoint = 0;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            endPoint = 1;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a10742.html#a29558ed008131ebedb6c3b965e9f4175">pointIndexHit</a>(eHit.hit(), eHit.rawPoint(), endPoint);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;}</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">// Go from selected edges only to a value for every edge</span></div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="a02484.html#a7d604d80e6ec2b5d31c0e4e799f946fd">   93</a></span>&#160;<a class="code" href="a01367.html">Foam::List&lt;Foam::surfaceFeatures::edgeStatus&gt;</a> <a class="code" href="a02484.html#a7d604d80e6ec2b5d31c0e4e799f946fd">Foam::surfaceFeatures::toStatus</a>()<span class="keyword"></span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keyword"> const</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="a01367.html">List&lt;edgeStatus&gt;</a> edgeStat(surf_.nEdges(), NONE);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// Region edges first</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = 0; i &lt; externalStart_; i++)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        edgeStat[featureEdges_[i]] = REGION;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// External edges</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = externalStart_; i &lt; internalStart_; i++)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        edgeStat[featureEdges_[i]] = EXTERNAL;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// Internal edges</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = internalStart_; i &lt; featureEdges_.size(); i++)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        edgeStat[featureEdges_[i]] = INTERNAL;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> edgeStat;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">// Set from value for every edge</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a02484.html#a3ec4130a2f02e6be2ba97774910eb125">Foam::surfaceFeatures::setFromStatus</a></div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="a02484.html#a3ec4130a2f02e6be2ba97774910eb125">  122</a></span>&#160;(</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">List&lt;edgeStatus&gt;</a>&amp; edgeStat,</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">const</span> scalar includedAngle</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Count</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nRegion = 0;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nExternal = 0;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nInternal = 0;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(edgeStat, edgeI)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> (edgeStat[edgeI] == REGION)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            nRegion++;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (edgeStat[edgeI] == EXTERNAL)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            nExternal++;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (edgeStat[edgeI] == INTERNAL)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            nInternal++;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    externalStart_ = nRegion;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    internalStart_ = externalStart_ + nExternal;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// Copy</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    featureEdges_.setSize(internalStart_ + nInternal);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> regionI = 0;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> externalI = externalStart_;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> internalI = internalStart_;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(edgeStat, edgeI)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">if</span> (edgeStat[edgeI] == REGION)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            featureEdges_[regionI++] = edgeI;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (edgeStat[edgeI] == EXTERNAL)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            featureEdges_[externalI++] = edgeI;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (edgeStat[edgeI] == INTERNAL)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            featureEdges_[internalI++] = edgeI;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keyword">const</span> scalar minCos = <a class="code" href="a10742.html#aebb41a148f7cf44b63e12f69e487e49f">Foam::cos</a>(<a class="code" href="a10742.html#af706f965be4d1457b0f1e7fade1c0118">degToRad</a>(180.0 - includedAngle));</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    calcFeatPoints(edgeStat, minCos);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">//construct feature points where more than 2 feature edges meet</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keywordtype">void</span> Foam::surfaceFeatures::calcFeatPoints</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;(</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">List&lt;edgeStatus&gt;</a>&amp; edgeStat,</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keyword">const</span> scalar minCos</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;{</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="a00605.html">DynamicList&lt;label&gt;</a> featurePoints(surf_.nPoints()/1000);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelListList</a>&amp; pointEdges = surf_.pointEdges();</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">edgeList</a>&amp; edges = surf_.edges();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; localPoints = surf_.localPoints();</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointEdges, pointI)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; pEdges = pointEdges[pointI];</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nFeatEdges = 0;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pEdges, i)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">if</span> (edgeStat[pEdges[i]] != NONE)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                nFeatEdges++;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">if</span> (nFeatEdges &gt; 2)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            featurePoints.<a class="code" href="a01367.html#a399dd2bf0d9a32016717dc90126f016b">append</a>(pointI);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nFeatEdges == 2)</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="comment">// Check the angle between the two edges</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <a class="code" href="a00605.html">DynamicList&lt;vector&gt;</a> edgeVecs(2);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pEdges, i)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> edgeI = pEdges[i];</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="keywordflow">if</span> (edgeStat[edgeI] != NONE)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    edgeVecs.<a class="code" href="a00605.html#a7b67b42af715604376ad63a681dee6d8">append</a>(edges[edgeI].vec(localPoints));</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    edgeVecs.<a class="code" href="a02741.html#aef07c02ea1c27bdb5906043b399e0ff0">last</a>() /= <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(edgeVecs.<a class="code" href="a02741.html#aef07c02ea1c27bdb5906043b399e0ff0">last</a>());</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(edgeVecs[0] &amp; edgeVecs[1]) &lt; minCos)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                featurePoints.<a class="code" href="a01367.html#a399dd2bf0d9a32016717dc90126f016b">append</a>(pointI);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    featurePoints_.transfer(featurePoints);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordtype">void</span> Foam::surfaceFeatures::classifyFeatureAngles</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;(</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelListList</a>&amp; edgeFaces,</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="a01367.html">List&lt;edgeStatus&gt;</a>&amp; edgeStat,</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keyword">const</span> scalar minCos,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> geometricTestOnly</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;)<span class="keyword"> const</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">vectorField</a>&amp; faceNormals = surf_.faceNormals();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; points = surf_.points();</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// Special case: minCos=1</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">bool</span> selectAll = (<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(minCos-1.0) &lt; SMALL);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(edgeFaces, edgeI)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; eFaces = edgeFaces[edgeI];</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">if</span> (eFaces.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>() != 2)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">// Non-manifold. What to do here? Is region edge? external edge?</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            edgeStat[edgeI] = REGION;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> face0 = eFaces[0];</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> face1 = eFaces[1];</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            (</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                !geometricTestOnly</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;             &amp;&amp; surf_[face0].region() != surf_[face1].region()</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            )</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                edgeStat[edgeI] = REGION;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            (</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                selectAll</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;             || ((faceNormals[face0] &amp; faceNormals[face1]) &lt; minCos)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            )</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <span class="comment">// Check if convex or concave by looking at angle</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="comment">// between face centres and normal</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <a class="code" href="a02797.html">vector</a> f0Tof1 =</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    surf_[face1].<a class="code" href="a02797.html#a14e7470ec1c401bcd5b0330c73e5cc8a">centre</a>(points)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                  - surf_[face0].<a class="code" href="a02797.html#a14e7470ec1c401bcd5b0330c73e5cc8a">centre</a>(points);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <span class="keywordflow">if</span> ((f0Tof1 &amp; faceNormals[face0]) &gt;= 0.0)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    edgeStat[edgeI] = INTERNAL;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    edgeStat[edgeI] = EXTERNAL;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">// Returns next feature edge connected to pointI with correct value.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">Foam::label</a> Foam::surfaceFeatures::nextFeatEdge</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;(</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">List&lt;edgeStatus&gt;</a>&amp; edgeStat,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; featVisited,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> unsetVal,</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> prevEdgeI,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> vertI</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;)<span class="keyword"> const</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; pEdges = surf_.pointEdges()[vertI];</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nextEdgeI = -1;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pEdges, i)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> edgeI = pEdges[i];</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">if</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        (</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            edgeI != prevEdgeI</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;         &amp;&amp; edgeStat[edgeI] != NONE</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;         &amp;&amp; featVisited[edgeI] == unsetVal</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        )</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">if</span> (nextEdgeI == -1)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                nextEdgeI = edgeI;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="comment">// More than one feature edge to choose from. End of segment.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">return</span> nextEdgeI;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">// Finds connected feature edges by walking from prevEdgeI in direction of</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">// prevPointI. Marks feature edges visited in featVisited by assigning them</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">// the current feature line number. Returns cumulative length of edges walked.</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">// Works in one of two modes:</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">// - mark : step to edges with featVisited = -1.</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">//          Mark edges visited with currentFeatI.</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">// - clear : step to edges with featVisited = currentFeatI</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">//           Mark edges visited with -2 and erase from feature edges.</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;Foam::surfaceFeatures::labelScalar Foam::surfaceFeatures::walkSegment</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;(</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> mark,</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">List&lt;edgeStatus&gt;</a>&amp; edgeStat,</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> startEdgeI,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> startPointI,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> currentFeatI,</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="a01367.html">labelList</a>&amp; featVisited</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;{</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> edgeI = startEdgeI;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> vertI = startPointI;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    scalar visitedLength = 0.0;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nVisited = 0;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a10742.html#ac16695f83f370df159eed19f92d095fb">findIndex</a>(featurePoints_, startPointI) &gt;= 0)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">// Do not walk across feature points</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">return</span> labelScalar(nVisited, visitedLength);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// Now we have:</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">//    edgeI : first edge on this segment</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">//    vertI : one of the endpoints of this segment</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// Start walking, marking off edges (in featVisited)</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// as we go along.</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> unsetVal;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (mark)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        unsetVal = -1;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        unsetVal = currentFeatI;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="comment">// Step to next feature edge with value unsetVal</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        edgeI = nextFeatEdge(edgeStat, featVisited, unsetVal, edgeI, vertI);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">if</span> (edgeI == -1 || edgeI == startEdgeI)</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="comment">// Mark with current value. If in clean mode also remove feature edge.</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">if</span> (mark)</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            featVisited[edgeI] = currentFeatI;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            featVisited[edgeI] = -2;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">// Step to next vertex on edge</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; <a class="code" href="a10742.html#a4225a7492f7d468ad5b985282c8ee7b1">e</a> = surf_.edges()[edgeI];</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        vertI = e.<a class="code" href="a00613.html#ab53e2468b3b9d33c35dc8be5c6867e0f">otherVertex</a>(vertI);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">// Update cumulative length</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        visitedLength += e.<a class="code" href="a00613.html#ac47b383852677ce70d239fc1c06b500d">mag</a>(surf_.localPoints());</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        nVisited++;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (nVisited &gt; surf_.nEdges())</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <a class="code" href="a10742.html#af62a190ccee72226ab0f985f42cb7b4e">Warning</a>&lt;&lt; <span class="stringliteral">&quot;walkSegment : reached iteration limit in walking &quot;</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;feature edges on surface from edge:&quot;</span> &lt;&lt; startEdgeI</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; vertex:&quot;</span> &lt;&lt; startPointI &lt;&lt; <a class="code" href="a10742.html#ae53117a9770efe95d2d01bb5cc2c99ef">nl</a></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Returning with large length&quot;</span> &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordflow">return</span> labelScalar(nVisited, GREAT);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">return</span> labelScalar(nVisited, visitedLength);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">// * * * * * * * * * * * * * * * * Constructors  * * * * * * * * * * * * * * //</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="a02484.html#a1d250089d155faf127da07f5484f0370">  448</a></span>&#160;<a class="code" href="a02484.html#a1d250089d155faf127da07f5484f0370">Foam::surfaceFeatures::surfaceFeatures</a>(<span class="keyword">const</span> <a class="code" href="a02689.html">triSurface</a>&amp; surf)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;:</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    surf_(surf),</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    featurePoints_(0),</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    featureEdges_(0),</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    externalStart_(0),</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    internalStart_(0)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;{}</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">// Construct from components.</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<a class="code" href="a02484.html#a1d250089d155faf127da07f5484f0370">Foam::surfaceFeatures::surfaceFeatures</a></div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="a02484.html#a5c898e64191427a2f4254887e6d99bcd">  460</a></span>&#160;(</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keyword">const</span> <a class="code" href="a02689.html">triSurface</a>&amp; surf,</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; featurePoints,</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; featureEdges,</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> externalStart,</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> internalStart</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;:</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    surf_(surf),</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    featurePoints_(featurePoints),</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    featureEdges_(featureEdges),</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    externalStart_(externalStart),</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    internalStart_(externalStart)</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;{}</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">// Construct from surface, angle and min length</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<a class="code" href="a02484.html#a1d250089d155faf127da07f5484f0370">Foam::surfaceFeatures::surfaceFeatures</a></div><div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="a02484.html#afc7064ce3ff927a21dde8ddbe2437f1c">  478</a></span>&#160;(</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keyword">const</span> <a class="code" href="a02689.html">triSurface</a>&amp; surf,</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keyword">const</span> scalar includedAngle,</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keyword">const</span> scalar minLen,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> minElems,</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> geometricTestOnly</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;:</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    surf_(surf),</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    featurePoints_(0),</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    featureEdges_(0),</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    externalStart_(0),</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    internalStart_(0)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="a02484.html#a104ad1549afa89b0b6ae590fda99816a">findFeatures</a>(includedAngle, geometricTestOnly);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span> (minLen &gt; 0 || minElems &gt; 0)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="a02484.html#af640d0750bcc401bc012c69e60b809a8">trimFeatures</a>(minLen, minElems, includedAngle);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">//- Construct from dictionary</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<a class="code" href="a02484.html#a1d250089d155faf127da07f5484f0370">Foam::surfaceFeatures::surfaceFeatures</a></div><div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="a02484.html#a55ea45be4ee1b0fde58f17d953b90084">  503</a></span>&#160;(</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keyword">const</span> <a class="code" href="a02689.html">triSurface</a>&amp; surf,</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00525.html">dictionary</a>&amp; featInfoDict</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;)</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;:</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    surf_(surf),</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    featurePoints_(featInfoDict.<a class="code" href="a00525.html#a8baab402d653d6e789f67c57e23a5b59">lookup</a>(<span class="stringliteral">&quot;featurePoints&quot;</span>)),</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    featureEdges_(featInfoDict.<a class="code" href="a00525.html#a8baab402d653d6e789f67c57e23a5b59">lookup</a>(<span class="stringliteral">&quot;featureEdges&quot;</span>)),</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    externalStart_(<a class="code" href="a10742.html#abb09fbcf651d29208982dd7a601b606f">readLabel</a>(featInfoDict.<a class="code" href="a00525.html#a8baab402d653d6e789f67c57e23a5b59">lookup</a>(<span class="stringliteral">&quot;externalStart&quot;</span>))),</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    internalStart_(<a class="code" href="a10742.html#abb09fbcf651d29208982dd7a601b606f">readLabel</a>(featInfoDict.<a class="code" href="a00525.html#a8baab402d653d6e789f67c57e23a5b59">lookup</a>(<span class="stringliteral">&quot;internalStart&quot;</span>)))</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{}</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">//- Construct from file</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<a class="code" href="a02484.html#a1d250089d155faf127da07f5484f0370">Foam::surfaceFeatures::surfaceFeatures</a></div><div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="a02484.html#a194e47cf291844d5b288b771201690d7">  518</a></span>&#160;(</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keyword">const</span> <a class="code" href="a02689.html">triSurface</a>&amp; surf,</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00781.html">fileName</a>&amp; fName</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;:</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    surf_(surf),</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    featurePoints_(0),</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    featureEdges_(0),</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    externalStart_(0),</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    internalStart_(0)</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;{</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="a01034.html">IFstream</a> str(fName);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="a00525.html">dictionary</a> featInfoDict(str);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    featureEdges_ = <a class="code" href="a10742.html#a1cb143a027019075df276006651d7048">labelList</a>(featInfoDict.<a class="code" href="a00525.html#a8baab402d653d6e789f67c57e23a5b59">lookup</a>(<span class="stringliteral">&quot;featureEdges&quot;</span>));</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    featurePoints_ = <a class="code" href="a10742.html#a1cb143a027019075df276006651d7048">labelList</a>(featInfoDict.<a class="code" href="a00525.html#a8baab402d653d6e789f67c57e23a5b59">lookup</a>(<span class="stringliteral">&quot;featurePoints&quot;</span>));</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    externalStart_ = <a class="code" href="a10742.html#abb09fbcf651d29208982dd7a601b606f">readLabel</a>(featInfoDict.<a class="code" href="a00525.html#a8baab402d653d6e789f67c57e23a5b59">lookup</a>(<span class="stringliteral">&quot;externalStart&quot;</span>));</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    internalStart_ = <a class="code" href="a10742.html#abb09fbcf651d29208982dd7a601b606f">readLabel</a>(featInfoDict.<a class="code" href="a00525.html#a8baab402d653d6e789f67c57e23a5b59">lookup</a>(<span class="stringliteral">&quot;internalStart&quot;</span>));</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<a class="code" href="a02484.html#a1d250089d155faf127da07f5484f0370">Foam::surfaceFeatures::surfaceFeatures</a></div><div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="a02484.html#ad37c6263cbba065fbffe29e843e18245">  541</a></span>&#160;(</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keyword">const</span> <a class="code" href="a02689.html">triSurface</a>&amp; surf,</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; points,</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">edgeList</a>&amp; edges,</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keyword">const</span> scalar mergeTol,</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> geometricTestOnly</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;)</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;:</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    surf_(surf),</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    featurePoints_(0),</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    featureEdges_(0),</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    externalStart_(0),</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    internalStart_(0)</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;{</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// Match edge mesh edges with the triSurface edges</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelListList</a>&amp; surfEdgeFaces = surf_.<a class="code" href="a01977.html#ab456054a1e7e1a07261799f50167916f">edgeFaces</a>();</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">edgeList</a>&amp; surfEdges = surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>();</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    scalar mergeTolSqr = <a class="code" href="a10742.html#a277dc11c581d53826ab5090b08f3b17b">sqr</a>(mergeTol);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="a00617.html">EdgeMap&lt;label&gt;</a> dynFeatEdges(2*edges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="a00605.html">DynamicList&lt;labelList&gt;</a> dynFeatureEdgeFaces(edges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="a01367.html">labelList</a> edgeLabel;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <a class="code" href="a02484.html#a1886e792c1c3df0142ae87adadbd7aef">nearestFeatEdge</a></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    (</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        edges,</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        points,</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        mergeTolSqr,</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        edgeLabel     <span class="comment">// label of surface edge or -1</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    );</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> count = 0;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(edgeLabel, sEdgeI)</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sEdge = edgeLabel[sEdgeI];</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">if</span> (sEdge == -1)</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        dynFeatEdges.<a class="code" href="a00987.html#a5eee1e0e199ad59b9cb3916cd42156e0">insert</a>(surfEdges[sEdge], count++);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        dynFeatureEdgeFaces.append(surfEdgeFaces[sEdge]);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">// Find whether an edge is external or internal</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="a01367.html">List&lt;edgeStatus&gt;</a> edgeStat(dynFeatEdges.size(), <a class="code" href="a02484.html#a9bf24153af0cf5754b35c9cae8de8ce2ac157bdf0b85a40d2619cbc8bc1ae5fe2">NONE</a>);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    classifyFeatureAngles</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    (</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        dynFeatureEdgeFaces,</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        edgeStat,</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        GREAT,</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        geometricTestOnly</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    );</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">// Transfer the edge status to a list encompassing all edges in the surface</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">// so that calcFeatPoints can be used.</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <a class="code" href="a01367.html">List&lt;edgeStatus&gt;</a> allEdgeStat(surf_.<a class="code" href="a01977.html#a1db9478309c639504a743b7b194226f4">nEdges</a>(), <a class="code" href="a02484.html#a9bf24153af0cf5754b35c9cae8de8ce2ac157bdf0b85a40d2619cbc8bc1ae5fe2">NONE</a>);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(allEdgeStat, eI)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="a00617.html">EdgeMap&lt;label&gt;::const_iterator</a> iter = dynFeatEdges.<a class="code" href="a00987.html#a76b2c74ebd9f33fa9f76261b027ffc11">find</a>(surfEdges[eI]);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">if</span> (iter != dynFeatEdges.<a class="code" href="a00988.html#a540580a296c0ff351686ceb4f27b6fe6">end</a>())</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            allEdgeStat[eI] = edgeStat[iter()];</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    edgeStat.<a class="code" href="a01367.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    dynFeatEdges.clear();</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="a02484.html#a3ec4130a2f02e6be2ba97774910eb125">setFromStatus</a>(allEdgeStat, GREAT);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;}</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">//- Construct as copy</span></div><div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="a02484.html#a65108d5f7a1a8bd4351ee2430c0bb955">  622</a></span>&#160;<a class="code" href="a02484.html#a1d250089d155faf127da07f5484f0370">Foam::surfaceFeatures::surfaceFeatures</a>(<span class="keyword">const</span> <a class="code" href="a02484.html">surfaceFeatures</a>&amp; <a class="code" href="a04326.html#ab318caaec810447a252e6134c88a7a77">sf</a>)</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;:</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    surf_(sf.<a class="code" href="a02484.html#ad324bdf983edf0e82844ade150fdca87">surface</a>()),</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    featurePoints_(sf.featurePoints()),</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    featureEdges_(sf.featureEdges()),</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    externalStart_(sf.externalStart()),</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    internalStart_(sf.internalStart())</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;{}</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">// * * * * * * * * * * * * * * * Member Functions  * * * * * * * * * * * * * //</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<a class="code" href="a01367.html">Foam::labelList</a> <a class="code" href="a02484.html#a64c6ffeea50313e7c5f4ab5a651d690d">Foam::surfaceFeatures::selectFeatureEdges</a></div><div class="line"><a name="l00635"></a><span class="lineno"><a class="line" href="a02484.html#a64c6ffeea50313e7c5f4ab5a651d690d">  635</a></span>&#160;(</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> regionEdges,</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> externalEdges,</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> internalEdges</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;) <span class="keyword">const</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;{</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="a00605.html">DynamicList&lt;label&gt;</a> selectedEdges;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">if</span> (regionEdges)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        selectedEdges.<a class="code" href="a00605.html#a3769bf93f15609625d62b693c566bcd1">setCapacity</a>(selectedEdges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>() + <a class="code" href="a02484.html#a24a846546c009c971cd77d7d91983cbb">nRegionEdges</a>());</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = 0; i &lt; externalStart_; i++)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            selectedEdges.<a class="code" href="a00605.html#a7b67b42af715604376ad63a681dee6d8">append</a>(featureEdges_[i]);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">if</span> (externalEdges)</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        selectedEdges.<a class="code" href="a00605.html#a3769bf93f15609625d62b693c566bcd1">setCapacity</a>(selectedEdges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>() + <a class="code" href="a02484.html#a2ddc9381af9dfe17313e19d2035085f7">nExternalEdges</a>());</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = externalStart_; i &lt; internalStart_; i++)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            selectedEdges.<a class="code" href="a00605.html#a7b67b42af715604376ad63a681dee6d8">append</a>(featureEdges_[i]);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">if</span> (internalEdges)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        selectedEdges.<a class="code" href="a00605.html#a3769bf93f15609625d62b693c566bcd1">setCapacity</a>(selectedEdges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>() + <a class="code" href="a02484.html#a3b322af5609b09f5d4f4b6fda11930df">nInternalEdges</a>());</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = internalStart_; i &lt; featureEdges_.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>(); i++)</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            selectedEdges.<a class="code" href="a00605.html#a7b67b42af715604376ad63a681dee6d8">append</a>(featureEdges_[i]);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">return</span> selectedEdges.<a class="code" href="a00605.html#a88964e734acd91f096c914d0cc5a6e75">shrink</a>();</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;}</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a02484.html#a104ad1549afa89b0b6ae590fda99816a">Foam::surfaceFeatures::findFeatures</a></div><div class="line"><a name="l00678"></a><span class="lineno"><a class="line" href="a02484.html#a104ad1549afa89b0b6ae590fda99816a">  678</a></span>&#160;(</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keyword">const</span> scalar includedAngle,</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> geometricTestOnly</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;{</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    scalar minCos = <a class="code" href="a10742.html#aebb41a148f7cf44b63e12f69e487e49f">Foam::cos</a>(<a class="code" href="a10742.html#af706f965be4d1457b0f1e7fade1c0118">degToRad</a>(180.0 - includedAngle));</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">// Per edge whether is feature edge.</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <a class="code" href="a01367.html">List&lt;edgeStatus&gt;</a> edgeStat(surf_.<a class="code" href="a01977.html#a1db9478309c639504a743b7b194226f4">nEdges</a>(), <a class="code" href="a02484.html#a9bf24153af0cf5754b35c9cae8de8ce2ac157bdf0b85a40d2619cbc8bc1ae5fe2">NONE</a>);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    classifyFeatureAngles</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    (</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        surf_.<a class="code" href="a01977.html#ab456054a1e7e1a07261799f50167916f">edgeFaces</a>(),</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        edgeStat,</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        minCos,</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        geometricTestOnly</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    );</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="a02484.html#a3ec4130a2f02e6be2ba97774910eb125">setFromStatus</a>(edgeStat, includedAngle);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">// Remove small strings of edges. First assigns string number to</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">// every edge and then works out the length of them.</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<a class="code" href="a01367.html">Foam::labelList</a> <a class="code" href="a02484.html#af640d0750bcc401bc012c69e60b809a8">Foam::surfaceFeatures::trimFeatures</a></div><div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="a02484.html#af640d0750bcc401bc012c69e60b809a8">  703</a></span>&#160;(</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keyword">const</span> scalar minLen,</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> minElems,</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keyword">const</span> scalar includedAngle</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;)</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;{</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">// Convert feature edge list to status per edge.</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="a01367.html">List&lt;edgeStatus&gt;</a> edgeStat(<a class="code" href="a02484.html#a7d604d80e6ec2b5d31c0e4e799f946fd">toStatus</a>());</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">// Mark feature edges according to connected lines.</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">// -1: unassigned</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">// -2: part of too small a feature line</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// &gt;0: feature line number</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="a01367.html">labelList</a> featLines(surf_.<a class="code" href="a01977.html#a1db9478309c639504a743b7b194226f4">nEdges</a>(), -1);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">// Current featureline number.</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> featI = 0;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">// Current starting edge</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> startEdgeI = 0;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="comment">// Find unset featureline</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="keywordflow">for</span> (; startEdgeI &lt; edgeStat.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>(); startEdgeI++)</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        {</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="keywordflow">if</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            (</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                edgeStat[startEdgeI] != <a class="code" href="a02484.html#a9bf24153af0cf5754b35c9cae8de8ce2ac157bdf0b85a40d2619cbc8bc1ae5fe2">NONE</a></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;             &amp;&amp; featLines[startEdgeI] == -1</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            )</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                <span class="comment">// Found unassigned feature edge.</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keywordflow">if</span> (startEdgeI == edgeStat.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>())</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <span class="comment">// No unset feature edge found. All feature edges have line number</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="comment">// assigned.</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        featLines[startEdgeI] = featI;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; startEdge = surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>()[startEdgeI];</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="comment">// Walk &#39;left&#39; and &#39;right&#39; from startEdge.</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        labelScalar leftPath =</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            walkSegment</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            (</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <span class="keyword">true</span>,           <span class="comment">// &#39;mark&#39; mode</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                edgeStat,</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                startEdgeI,     <span class="comment">// edge, not yet assigned to a featureLine</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                startEdge[0],   <span class="comment">// start of edge</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                featI,          <span class="comment">// Mark value</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                featLines       <span class="comment">// Mark for all edges</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            );</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        labelScalar rightPath =</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            walkSegment</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            (</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <span class="keyword">true</span>,</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                edgeStat,</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                startEdgeI,</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                startEdge[1],   <span class="comment">// end of edge</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                featI,</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                featLines</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            );</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordflow">if</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        (</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            (</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                leftPath.len_</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;              + rightPath.len_</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;              + startEdge.<a class="code" href="a00613.html#ac47b383852677ce70d239fc1c06b500d">mag</a>(surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>())</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;              &lt; minLen</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            )</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;         || (leftPath.n_ + rightPath.n_ + 1 &lt; minElems)</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        )</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        {</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="comment">// Rewalk same route (recognizable by featLines == featI)</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="comment">// to reset featLines.</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            featLines[startEdgeI] = -2;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            walkSegment</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            (</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <span class="keyword">false</span>,          <span class="comment">// &#39;clean&#39; mode</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                edgeStat,</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                startEdgeI,     <span class="comment">// edge, not yet assigned to a featureLine</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                startEdge[0],   <span class="comment">// start of edge</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                featI,          <span class="comment">// Unset value</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                featLines       <span class="comment">// Mark for all edges</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            );</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            walkSegment</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            (</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                <span class="keyword">false</span>,</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                edgeStat,</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                startEdgeI,</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                startEdge[1],   <span class="comment">// end of edge</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                featI,</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                featLines</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            );</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            featI++;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// Unmark all feature lines that have featLines=-2</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(featureEdges_, i)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> edgeI = featureEdges_[i];</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordflow">if</span> (featLines[edgeI] == -2)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            edgeStat[edgeI] = <a class="code" href="a02484.html#a9bf24153af0cf5754b35c9cae8de8ce2ac157bdf0b85a40d2619cbc8bc1ae5fe2">NONE</a>;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    }</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="comment">// Convert back to edge labels</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <a class="code" href="a02484.html#a3ec4130a2f02e6be2ba97774910eb125">setFromStatus</a>(edgeStat, includedAngle);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">return</span> featLines;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;}</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno"><a class="line" href="a02484.html#af77027c10b89b764f28cf777c66c4be6">  836</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a02484.html#af77027c10b89b764f28cf777c66c4be6">Foam::surfaceFeatures::writeDict</a>(<a class="code" href="a01742.html">Ostream</a>&amp; writeFile)<span class="keyword"> const</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <a class="code" href="a00525.html">dictionary</a> featInfoDict;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    featInfoDict.<a class="code" href="a00525.html#ac2ddcab42322c8d8af5e5830ab4d431b">add</a>(<span class="stringliteral">&quot;externalStart&quot;</span>, externalStart_);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    featInfoDict.<a class="code" href="a00525.html#ac2ddcab42322c8d8af5e5830ab4d431b">add</a>(<span class="stringliteral">&quot;internalStart&quot;</span>, internalStart_);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    featInfoDict.<a class="code" href="a00525.html#ac2ddcab42322c8d8af5e5830ab4d431b">add</a>(<span class="stringliteral">&quot;featureEdges&quot;</span>, featureEdges_);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    featInfoDict.<a class="code" href="a00525.html#ac2ddcab42322c8d8af5e5830ab4d431b">add</a>(<span class="stringliteral">&quot;featurePoints&quot;</span>, featurePoints_);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    featInfoDict.<a class="code" href="a00525.html#a4a8c5a25ca68b97e8408d4016287b5e2">write</a>(writeFile);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;}</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno"><a class="line" href="a02484.html#acdfdabbbb3782b001588a413f9f379e9">  849</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a02484.html#acdfdabbbb3782b001588a413f9f379e9">Foam::surfaceFeatures::write</a>(<span class="keyword">const</span> <a class="code" href="a00781.html">fileName</a>&amp; fName)<span class="keyword"> const</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="a01709.html">OFstream</a> str(fName);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="a02484.html#af77027c10b89b764f28cf777c66c4be6">writeDict</a>(str);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;}</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno"><a class="line" href="a02484.html#af78e21d23a56aa4355af14059f2b2770">  857</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a02484.html#af78e21d23a56aa4355af14059f2b2770">Foam::surfaceFeatures::writeObj</a>(<span class="keyword">const</span> <a class="code" href="a00781.html">fileName</a>&amp; prefix)<span class="keyword"> const</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <a class="code" href="a01709.html">OFstream</a> regionStr(prefix + <span class="stringliteral">&quot;_regionEdges.obj&quot;</span>);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <span class="stringliteral">&quot;Writing region edges to &quot;</span> &lt;&lt; regionStr.<a class="code" href="a01709.html#acd3da3556711337d571c60cf9ffb91cc">name</a>() &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> verti = 0;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = 0; i &lt; externalStart_; i++)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; <a class="code" href="a10742.html#a4225a7492f7d468ad5b985282c8ee7b1">e</a> = surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>()[featureEdges_[i]];</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(regionStr, surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>()[e[0]]); verti++;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(regionStr, surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>()[e[1]]); verti++;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        regionStr &lt;&lt; <span class="stringliteral">&quot;l &quot;</span> &lt;&lt; verti-1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; verti &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <a class="code" href="a01709.html">OFstream</a> externalStr(prefix + <span class="stringliteral">&quot;_externalEdges.obj&quot;</span>);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <span class="stringliteral">&quot;Writing external edges to &quot;</span> &lt;&lt; externalStr.<a class="code" href="a01709.html#acd3da3556711337d571c60cf9ffb91cc">name</a>() &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    verti = 0;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = externalStart_; i &lt; internalStart_; i++)</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; <a class="code" href="a10742.html#a4225a7492f7d468ad5b985282c8ee7b1">e</a> = surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>()[featureEdges_[i]];</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(externalStr, surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>()[e[0]]); verti++;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(externalStr, surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>()[e[1]]); verti++;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        externalStr &lt;&lt; <span class="stringliteral">&quot;l &quot;</span> &lt;&lt; verti-1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; verti &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <a class="code" href="a01709.html">OFstream</a> internalStr(prefix + <span class="stringliteral">&quot;_internalEdges.obj&quot;</span>);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <span class="stringliteral">&quot;Writing internal edges to &quot;</span> &lt;&lt; internalStr.<a class="code" href="a01709.html#acd3da3556711337d571c60cf9ffb91cc">name</a>() &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    verti = 0;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = internalStart_; i &lt; featureEdges_.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>(); i++)</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; <a class="code" href="a10742.html#a4225a7492f7d468ad5b985282c8ee7b1">e</a> = surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>()[featureEdges_[i]];</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(internalStr, surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>()[e[0]]); verti++;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(internalStr, surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>()[e[1]]); verti++;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        internalStr &lt;&lt; <span class="stringliteral">&quot;l &quot;</span> &lt;&lt; verti-1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; verti &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    }</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <a class="code" href="a01709.html">OFstream</a> pointStr(prefix + <span class="stringliteral">&quot;_points.obj&quot;</span>);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <span class="stringliteral">&quot;Writing feature points to &quot;</span> &lt;&lt; pointStr.<a class="code" href="a01709.html#acd3da3556711337d571c60cf9ffb91cc">name</a>() &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(featurePoints_, i)</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> pointI = featurePoints_[i];</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(pointStr, surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>()[pointI]);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;}</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">// Get nearest vertex on patch for every point of surf in pointSet.</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<a class="code" href="a01404.html">Foam::Map&lt;Foam::label&gt;</a> <a class="code" href="a02484.html#a05b6a62c91ca3d68db42ba635ff1f307">Foam::surfaceFeatures::nearestSamples</a></div><div class="line"><a name="l00913"></a><span class="lineno"><a class="line" href="a02484.html#a05b6a62c91ca3d68db42ba635ff1f307">  913</a></span>&#160;(</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; pointLabels,</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; samples,</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">scalarField</a>&amp; maxDistSqr</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;) <span class="keyword">const</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;{</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="comment">// Build tree out of all samples.</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">// Note: cannot be done one the fly - gcc4.4 compiler bug.</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <a class="code" href="a02677.html">treeBoundBox</a> bb(samples);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <a class="code" href="a01057.html">indexedOctree&lt;treeDataPoint&gt;</a> ppTree</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    (</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <a class="code" href="a02681.html">treeDataPoint</a>(samples),   <span class="comment">// all information needed to do checks</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        bb,                       <span class="comment">// overall search domain</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        8,      <span class="comment">// maxLevel</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        10,     <span class="comment">// leafsize</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        3.0     <span class="comment">// duplicity</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    );</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// From patch point to surface point</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <a class="code" href="a01404.html">Map&lt;label&gt;</a> nearest(2*pointLabels.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; surfPoints = surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>();</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(pointLabels, i)</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> surfPointI = pointLabels[i];</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="keyword">const</span> <a class="code" href="a02797.html">point</a>&amp; surfPt = surfPoints[surfPointI];</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <a class="code" href="a01890.html">pointIndexHit</a> info = ppTree.findNearest</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        (</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            surfPt,</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            maxDistSqr[i]</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        );</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <span class="keywordflow">if</span> (!info.<a class="code" href="a01890.html#ad963d38a624b8bf8b37c210109dba03c">hit</a>())</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <a class="code" href="a07738.html#af2484eff8084de37cba5d9d7a00fb293">FatalErrorInFunction</a></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Problem for point &quot;</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                &lt;&lt; surfPointI &lt;&lt; <span class="stringliteral">&quot; in tree &quot;</span> &lt;&lt; ppTree.<a class="code" href="a01057.html#af955c64dcfefdc4ac1d969621016d443">bb</a>()</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                &lt;&lt; <a class="code" href="a10742.html#a447107a607d03e417307c203fa5fb44b">abort</a>(<a class="code" href="a10742.html#ac50d206700f3f71855dd30c9a076de43">FatalError</a>);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        }</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sampleI = info.<a class="code" href="a01890.html#a7d1e8acadb27bd2b4e61457d47b71b6f">index</a>();</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a10742.html#ae6fff2c6981e6d9618aa5038e69def6e">magSqr</a>(samples[sampleI] - surfPt) &lt; maxDistSqr[sampleI])</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            nearest.insert(sampleI, surfPointI);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">if</span> (debug)</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    {</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="comment">// Dump to obj file</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Dumping nearest surface feature points to nearestSamples.obj&quot;</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;View this Lightwave-OBJ file with e.g. javaview&quot;</span> &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <a class="code" href="a01709.html">OFstream</a> objStream(<span class="stringliteral">&quot;nearestSamples.obj&quot;</span>);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> vertI = 0;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <a class="code" href="a02966.html#ae21e2836509b0fa7f7cedf6493b11b09">forAllConstIter</a>(<a class="code" href="a01404.html">Map&lt;label&gt;</a>, nearest, iter)</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(objStream, samples[iter.key()]); vertI++;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(objStream, surfPoints[iter()]); vertI++;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            objStream&lt;&lt; <span class="stringliteral">&quot;l &quot;</span> &lt;&lt; vertI-1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; vertI &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">return</span> nearest;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;}</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">// Get nearest sample point for regularly sampled points along</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">// selected edges. Return map from sample to edge label</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<a class="code" href="a01404.html">Foam::Map&lt;Foam::label&gt;</a> <a class="code" href="a02484.html#a05b6a62c91ca3d68db42ba635ff1f307">Foam::surfaceFeatures::nearestSamples</a></div><div class="line"><a name="l00997"></a><span class="lineno"><a class="line" href="a02484.html#a24bd0a4e839c5c085b4d056e900b8073">  997</a></span>&#160;(</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; selectedEdges,</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; samples,</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">scalarField</a>&amp; sampleDist,</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">scalarField</a>&amp; maxDistSqr,</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keyword">const</span> scalar minSampleDist</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;) <span class="keyword">const</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;{</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; surfPoints = surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>();</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">edgeList</a>&amp; surfEdges = surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>();</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    scalar maxSearchSqr = <a class="code" href="a10742.html#ac993e906cf2774ae77e666bc24e81733">max</a>(maxDistSqr);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">//Note: cannot be done one the fly - gcc4.4 compiler bug.</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <a class="code" href="a02677.html">treeBoundBox</a> bb(samples);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="a01057.html">indexedOctree&lt;treeDataPoint&gt;</a> ppTree</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    (</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <a class="code" href="a02681.html">treeDataPoint</a>(samples),   <span class="comment">// all information needed to do checks</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        bb,                         <span class="comment">// overall search domain</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        8,      <span class="comment">// maxLevel</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        10,     <span class="comment">// leafsize</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        3.0     <span class="comment">// duplicity</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    );</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="comment">// From patch point to surface edge.</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <a class="code" href="a01404.html">Map&lt;label&gt;</a> nearest(2*selectedEdges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(selectedEdges, i)</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> surfEdgeI = selectedEdges[i];</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; <a class="code" href="a10742.html#a4225a7492f7d468ad5b985282c8ee7b1">e</a> = surfEdges[surfEdgeI];</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="keywordflow">if</span> (debug &amp;&amp; (i % 1000) == 0)</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        {</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <span class="stringliteral">&quot;looking at surface feature edge &quot;</span> &lt;&lt; surfEdgeI</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; verts:&quot;</span> &lt;&lt; e &lt;&lt; <span class="stringliteral">&quot; points:&quot;</span> &lt;&lt; surfPoints[e[0]]</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; surfPoints[e[1]] &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="comment">// Normalized edge vector</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <a class="code" href="a02797.html">vector</a> eVec = e.<a class="code" href="a00613.html#a9c85e25fb010469f9d04cd70d9250419">vec</a>(surfPoints);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        scalar eMag = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(eVec);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        eVec /= eMag;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="comment">// Sample along edge</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="a10742.html#a06ca7250d8e89caf05243ec094843642">exit</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="comment">// Coordinate along edge (0 .. eMag)</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        scalar <a class="code" href="a04287.html#a6d6b99210a64ad23792eb7a3b0411c42">s</a> = 0.0;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        {</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            <a class="code" href="a02797.html">point</a> edgePoint(surfPoints[e.<a class="code" href="a00613.html#a96b607a9a9baa575783b4af443ef613f">start</a>()] + s*eVec);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <a class="code" href="a01890.html">pointIndexHit</a> info = ppTree.findNearest</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            (</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                edgePoint,</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                maxSearchSqr</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            );</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordflow">if</span> (!info.hit())</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                <span class="comment">// No point close enough to surface edge.</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            }</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sampleI = info.index();</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="a10742.html#ae6fff2c6981e6d9618aa5038e69def6e">magSqr</a>(info.hitPoint() - edgePoint) &lt; maxDistSqr[sampleI])</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            {</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                nearest.insert(sampleI, surfEdgeI);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            }</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="keywordflow">if</span> (exit)</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            {</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            }</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <span class="comment">// Step to next sample point using local distance.</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="comment">// Truncate to max 1/minSampleDist samples per feature edge.</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            s += <a class="code" href="a10742.html#ac993e906cf2774ae77e666bc24e81733">max</a>(minSampleDist*eMag, sampleDist[sampleI]);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            <span class="keywordflow">if</span> (s &gt;= (1-minSampleDist)*eMag)</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                <span class="comment">// Do one more sample, at edge endpoint</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                s = eMag;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                exit = <span class="keyword">true</span>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            }</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        }</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    }</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">if</span> (debug)</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    {</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="comment">// Dump to obj file</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <span class="stringliteral">&quot;Dumping nearest surface edges to nearestEdges.obj\n&quot;</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;View this Lightwave-OBJ file with e.g. javaview\n&quot;</span> &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <a class="code" href="a01709.html">OFstream</a> objStream(<span class="stringliteral">&quot;nearestEdges.obj&quot;</span>);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> vertI = 0;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <a class="code" href="a02966.html#ae21e2836509b0fa7f7cedf6493b11b09">forAllConstIter</a>(<a class="code" href="a01404.html">Map&lt;label&gt;</a>, nearest, iter)</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sampleI = iter.key();</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(objStream, samples[sampleI]); vertI++;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; <a class="code" href="a10742.html#a4225a7492f7d468ad5b985282c8ee7b1">e</a> = surfEdges[iter()];</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <a class="code" href="a02797.html">point</a> nearPt =</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                e.<a class="code" href="a00613.html#aefea0e4a074dd0ba02419922ed063888">line</a>(surfPoints).<a class="code" href="a01332.html#a5793126218bf0f619549fc69390a1b51">nearestDist</a>(samples[sampleI]).rawPoint();</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(objStream, nearPt); vertI++;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            objStream&lt;&lt; <span class="stringliteral">&quot;l &quot;</span> &lt;&lt; vertI-1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; vertI &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        }</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordflow">return</span> nearest;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;}</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">// Get nearest edge on patch for regularly sampled points along the feature</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">// edges. Return map from patch edge to feature edge.</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">// Q: using point-based sampleDist and maxDist (distance to look around</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">// each point). Should they be edge-based e.g. by averaging or max()?</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<a class="code" href="a01404.html">Foam::Map&lt;Foam::pointIndexHit&gt;</a> <a class="code" href="a02484.html#ad0730de914a7db6da70faf38494a489d">Foam::surfaceFeatures::nearestEdges</a></div><div class="line"><a name="l01133"></a><span class="lineno"><a class="line" href="a02484.html#ad0730de914a7db6da70faf38494a489d"> 1133</a></span>&#160;(</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; selectedEdges,</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">edgeList</a>&amp; sampleEdges,</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; selectedSampleEdges,</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; samplePoints,</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">scalarField</a>&amp; sampleDist,</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">scalarField</a>&amp; maxDistSqr,</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keyword">const</span> scalar minSampleDist</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;) <span class="keyword">const</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;{</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="comment">// Build tree out of selected sample edges.</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <a class="code" href="a01057.html">indexedOctree&lt;treeDataEdge&gt;</a> ppTree</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    (</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <a class="code" href="a02679.html">treeDataEdge</a></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        (</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keyword">false</span>,</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            sampleEdges,</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            samplePoints,</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            selectedSampleEdges</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        ),                          <span class="comment">// geometric info container for edges</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <a class="code" href="a02677.html">treeBoundBox</a>(samplePoints), <span class="comment">// overall search domain</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        8,      <span class="comment">// maxLevel</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        10,     <span class="comment">// leafsize</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        3.0     <span class="comment">// duplicity</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    );</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; surfPoints = surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>();</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">edgeList</a>&amp; surfEdges = surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>();</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    scalar maxSearchSqr = <a class="code" href="a10742.html#ac993e906cf2774ae77e666bc24e81733">max</a>(maxDistSqr);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="a01404.html">Map&lt;pointIndexHit&gt;</a> nearest(2*sampleEdges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="comment">// Loop over all selected edges. Sample at regular intervals. Find nearest</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="comment">// sampleEdges (using octree)</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(selectedEdges, i)</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> surfEdgeI = selectedEdges[i];</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; <a class="code" href="a10742.html#a4225a7492f7d468ad5b985282c8ee7b1">e</a> = surfEdges[surfEdgeI];</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="keywordflow">if</span> (debug &amp;&amp; (i % 1000) == 0)</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <span class="stringliteral">&quot;looking at surface feature edge &quot;</span> &lt;&lt; surfEdgeI</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; verts:&quot;</span> &lt;&lt; e &lt;&lt; <span class="stringliteral">&quot; points:&quot;</span> &lt;&lt; surfPoints[e[0]]</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; surfPoints[e[1]] &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="comment">// Normalized edge vector</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        <a class="code" href="a02797.html">vector</a> eVec = e.<a class="code" href="a00613.html#a9c85e25fb010469f9d04cd70d9250419">vec</a>(surfPoints);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        scalar eMag = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(eVec);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        eVec /= eMag;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <span class="comment">// Sample along edge</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="a10742.html#a06ca7250d8e89caf05243ec094843642">exit</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="comment">// Coordinate along edge (0 .. eMag)</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        scalar <a class="code" href="a04287.html#a6d6b99210a64ad23792eb7a3b0411c42">s</a> = 0.0;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            <a class="code" href="a02797.html">point</a> edgePoint(surfPoints[e.<a class="code" href="a00613.html#a96b607a9a9baa575783b4af443ef613f">start</a>()] + s*eVec);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            <a class="code" href="a01890.html">pointIndexHit</a> info = ppTree.findNearest</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            (</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                edgePoint,</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                maxSearchSqr</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            );</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;            <span class="keywordflow">if</span> (!info.hit())</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            {</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                <span class="comment">// No edge close enough to surface edge.</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;            }</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> index = info.index();</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sampleEdgeI = ppTree.<a class="code" href="a01057.html#abd186b2cbd8c6def61dc033a4892b847">shapes</a>().edgeLabels()[index];</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;            <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; e = sampleEdges[sampleEdgeI];</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="a10742.html#ae6fff2c6981e6d9618aa5038e69def6e">magSqr</a>(info.hitPoint() - edgePoint) &lt; maxDistSqr[e.<a class="code" href="a00613.html#a96b607a9a9baa575783b4af443ef613f">start</a>()])</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                nearest.insert</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                (</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                    sampleEdgeI,</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                    <a class="code" href="a10742.html#a29558ed008131ebedb6c3b965e9f4175">pointIndexHit</a>(<span class="keyword">true</span>, edgePoint, surfEdgeI)</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                );</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;            <span class="keywordflow">if</span> (exit)</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            {</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            }</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <span class="comment">// Step to next sample point using local distance.</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            <span class="comment">// Truncate to max 1/minSampleDist samples per feature edge.</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            <span class="comment">// s += max(minSampleDist*eMag, sampleDist[e.start()]);</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            s += 0.01*eMag;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            <span class="keywordflow">if</span> (s &gt;= (1-minSampleDist)*eMag)</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            {</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                <span class="comment">// Do one more sample, at edge endpoint</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                s = eMag;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                exit = <span class="keyword">true</span>;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            }</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        }</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    }</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">if</span> (debug)</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    {</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="comment">// Dump to obj file</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <span class="stringliteral">&quot;Dumping nearest surface feature edges to nearestEdges.obj\n&quot;</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;View this Lightwave-OBJ file with e.g. javaview\n&quot;</span> &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <a class="code" href="a01709.html">OFstream</a> objStream(<span class="stringliteral">&quot;nearestEdges.obj&quot;</span>);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> vertI = 0;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <a class="code" href="a02966.html#ae21e2836509b0fa7f7cedf6493b11b09">forAllConstIter</a>(<a class="code" href="a01404.html">Map&lt;pointIndexHit&gt;</a>, nearest, iter)</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> sampleEdgeI = iter.key();</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; sampleEdge = sampleEdges[sampleEdgeI];</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <span class="comment">// Write line from edgeMid to point on feature edge</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(objStream, sampleEdge.<a class="code" href="a00613.html#ae686335a8e426b97037d6845043b7151">centre</a>(samplePoints));</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            vertI++;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(objStream, iter().rawPoint());</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            vertI++;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            objStream&lt;&lt; <span class="stringliteral">&quot;l &quot;</span> &lt;&lt; vertI-1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; vertI &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        }</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">return</span> nearest;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;}</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">// Get nearest surface edge for every sample. Return in form of</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">// labelLists giving surfaceEdge label&amp;intersectionpoint.</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a02484.html#ac9d88c671fbfe12e0526038fb054c11d">Foam::surfaceFeatures::nearestSurfEdge</a></div><div class="line"><a name="l01284"></a><span class="lineno"><a class="line" href="a02484.html#ac9d88c671fbfe12e0526038fb054c11d"> 1284</a></span>&#160;(</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; selectedEdges,</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; samples,</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    scalar searchSpanSqr,   <span class="comment">// Search span</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="a01367.html">labelList</a>&amp; edgeLabel,</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <a class="code" href="a01367.html">labelList</a>&amp; edgeEndPoint,</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <a class="code" href="a00756.html">pointField</a>&amp; edgePoint</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;) <span class="keyword">const</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;{</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    edgeLabel.<a class="code" href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">setSize</a>(samples.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    edgeEndPoint.<a class="code" href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">setSize</a>(samples.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    edgePoint.<a class="code" href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">setSize</a>(samples.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; localPoints = surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>();</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <a class="code" href="a02677.html">treeBoundBox</a> searchDomain(localPoints);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    searchDomain.<a class="code" href="a00156.html#a7264596c8566f5168aa2f5e795c884f4">inflate</a>(0.1);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <a class="code" href="a01057.html">indexedOctree&lt;treeDataEdge&gt;</a> ppTree</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    (</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <a class="code" href="a02679.html">treeDataEdge</a></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        (</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            <span class="keyword">false</span>,</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>(),</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            localPoints,</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            selectedEdges</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        ),          <span class="comment">// all information needed to do geometric checks</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        searchDomain,  <span class="comment">// overall search domain</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        8,      <span class="comment">// maxLevel</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        10,     <span class="comment">// leafsize</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        3.0     <span class="comment">// duplicity</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    );</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(samples, i)</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <span class="keyword">const</span> <a class="code" href="a02797.html">point</a>&amp; sample = samples[i];</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <a class="code" href="a01890.html">pointIndexHit</a> info = ppTree.findNearest</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        (</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            sample,</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            searchSpanSqr</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        );</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <span class="keywordflow">if</span> (!info.<a class="code" href="a01890.html#ad963d38a624b8bf8b37c210109dba03c">hit</a>())</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        {</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            edgeLabel[i] = -1;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        }</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        {</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            edgeLabel[i] = selectedEdges[info.<a class="code" href="a01890.html#a7d1e8acadb27bd2b4e61457d47b71b6f">index</a>()];</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            <span class="comment">// Need to recalculate to classify edgeEndPoint</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; <a class="code" href="a10742.html#a4225a7492f7d468ad5b985282c8ee7b1">e</a> = surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>()[edgeLabel[i]];</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <a class="code" href="a01890.html">pointIndexHit</a> pHit = edgeNearest</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            (</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                localPoints[e.<a class="code" href="a00613.html#a96b607a9a9baa575783b4af443ef613f">start</a>()],</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                localPoints[e.<a class="code" href="a00613.html#a8ed0e876210c2c116b5694307a830518">end</a>()],</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                sample</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            );</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            edgePoint[i] = pHit.<a class="code" href="a01890.html#a6c68a01f71e2d6a820e0f0e3540aff0f">rawPoint</a>();</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            edgeEndPoint[i] = pHit.<a class="code" href="a01890.html#a7d1e8acadb27bd2b4e61457d47b71b6f">index</a>();</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        }</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    }</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;}</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">// Get nearest point on nearest feature edge for every sample (is edge)</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a02484.html#ac9d88c671fbfe12e0526038fb054c11d">Foam::surfaceFeatures::nearestSurfEdge</a></div><div class="line"><a name="l01354"></a><span class="lineno"><a class="line" href="a02484.html#a2f41ee3f33384b2cf74f2485b7d03df9"> 1354</a></span>&#160;(</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; selectedEdges,</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">edgeList</a>&amp; sampleEdges,</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; selectedSampleEdges,</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; samplePoints,</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; searchSpan,   <span class="comment">// Search span</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <a class="code" href="a01367.html">labelList</a>&amp; edgeLabel,       <span class="comment">// label of surface edge or -1</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <a class="code" href="a00756.html">pointField</a>&amp; pointOnEdge,    <span class="comment">// point on above edge</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <a class="code" href="a00756.html">pointField</a>&amp; pointOnFeature  <span class="comment">// point on sample edge</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;) <span class="keyword">const</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;{</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    edgeLabel.<a class="code" href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">setSize</a>(selectedSampleEdges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    pointOnEdge.<a class="code" href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">setSize</a>(selectedSampleEdges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    pointOnFeature.<a class="code" href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">setSize</a>(selectedSampleEdges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <a class="code" href="a02677.html">treeBoundBox</a> searchDomain(surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>());</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <a class="code" href="a01057.html">indexedOctree&lt;treeDataEdge&gt;</a> ppTree</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    (</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <a class="code" href="a02679.html">treeDataEdge</a></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        (</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            <span class="keyword">false</span>,</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>(),</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>(),</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            selectedEdges</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        ),              <span class="comment">// all information needed to do geometric checks</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        searchDomain,   <span class="comment">// overall search domain</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        8,              <span class="comment">// maxLevel</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        10,             <span class="comment">// leafsize</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        3.0             <span class="comment">// duplicity</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    );</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(selectedSampleEdges, i)</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    {</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; <a class="code" href="a10742.html#a4225a7492f7d468ad5b985282c8ee7b1">e</a> = sampleEdges[selectedSampleEdges[i]];</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        <a class="code" href="a01332.html">linePointRef</a> edgeLine = e.<a class="code" href="a00613.html#aefea0e4a074dd0ba02419922ed063888">line</a>(samplePoints);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <a class="code" href="a02797.html">point</a> eMid(edgeLine.<a class="code" href="a01332.html#aa827cbb8a8c37bb9d4e1ef7eaa234792">centre</a>());</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        <a class="code" href="a02677.html">treeBoundBox</a> tightest(eMid - searchSpan, eMid + searchSpan);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <a class="code" href="a01890.html">pointIndexHit</a> info = ppTree.findNearest</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        (</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            edgeLine,</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;            tightest,</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;            pointOnEdge[i]</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        );</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <span class="keywordflow">if</span> (!info.<a class="code" href="a01890.html#ad963d38a624b8bf8b37c210109dba03c">hit</a>())</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        {</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            edgeLabel[i] = -1;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        }</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        {</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            edgeLabel[i] = selectedEdges[info.<a class="code" href="a01890.html#a7d1e8acadb27bd2b4e61457d47b71b6f">index</a>()];</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            pointOnFeature[i] = info.<a class="code" href="a01890.html#a0c448cd4b96e9ea9ba38c62c019a8bce">hitPoint</a>();</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        }</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    }</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;}</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="keywordtype">void</span> <a class="code" href="a02484.html#a1886e792c1c3df0142ae87adadbd7aef">Foam::surfaceFeatures::nearestFeatEdge</a></div><div class="line"><a name="l01420"></a><span class="lineno"><a class="line" href="a02484.html#a1886e792c1c3df0142ae87adadbd7aef"> 1420</a></span>&#160;(</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">edgeList</a>&amp; edges,</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; points,</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    scalar searchSpanSqr,   <span class="comment">// Search span</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <a class="code" href="a01367.html">labelList</a>&amp; edgeLabel</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;) <span class="keyword">const</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;{</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    edgeLabel = <a class="code" href="a10742.html#a1cb143a027019075df276006651d7048">labelList</a>(surf_.<a class="code" href="a01977.html#a1db9478309c639504a743b7b194226f4">nEdges</a>(), -1);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <a class="code" href="a02677.html">treeBoundBox</a> searchDomain(points);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    searchDomain.inflate(0.1);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <a class="code" href="a01057.html">indexedOctree&lt;treeDataEdge&gt;</a> ppTree</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    (</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <a class="code" href="a02679.html">treeDataEdge</a></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        (</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            <span class="keyword">false</span>,</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            edges,</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            points,</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            <a class="code" href="a10742.html#a36af96cb841435845fffb4fe69208490">identity</a>(edges.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>())</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        ),          <span class="comment">// all information needed to do geometric checks</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        searchDomain,  <span class="comment">// overall search domain</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        8,      <span class="comment">// maxLevel</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        10,     <span class="comment">// leafsize</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        3.0     <span class="comment">// duplicity</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    );</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">edgeList</a>&amp; surfEdges = surf_.<a class="code" href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">edges</a>();</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; surfLocalPoints = surf_.<a class="code" href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">localPoints</a>();</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(surfEdges, edgeI)</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    {</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; sample = surfEdges[edgeI];</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        <span class="keyword">const</span> <a class="code" href="a02797.html">point</a>&amp; startPoint = surfLocalPoints[sample.<a class="code" href="a00613.html#a96b607a9a9baa575783b4af443ef613f">start</a>()];</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <span class="keyword">const</span> <a class="code" href="a02797.html">point</a>&amp; <a class="code" href="a01488.html">midPoint</a> = sample.<a class="code" href="a00613.html#ae686335a8e426b97037d6845043b7151">centre</a>(surfLocalPoints);</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        <a class="code" href="a01890.html">pointIndexHit</a> infoMid = ppTree.findNearest</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        (</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            midPoint,</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            searchSpanSqr</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        );</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <span class="keywordflow">if</span> (infoMid.<a class="code" href="a01890.html#ad963d38a624b8bf8b37c210109dba03c">hit</a>())</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        {</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a> surfEdgeDir = midPoint - startPoint;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;            <span class="keyword">const</span> <a class="code" href="a00613.html">edge</a>&amp; featEdge = edges[infoMid.<a class="code" href="a01890.html#a7d1e8acadb27bd2b4e61457d47b71b6f">index</a>()];</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a> featEdgeDir = featEdge.<a class="code" href="a00613.html#a9c85e25fb010469f9d04cd70d9250419">vec</a>(points);</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            <span class="comment">// Check that the edges are nearly parallel</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(surfEdgeDir ^ featEdgeDir) &lt; parallelTolerance)</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            {</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                edgeLabel[edgeI] = edgeI;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            }</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        }</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    }</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;}</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">// * * * * * * * * * * * * * * * Member Operators  * * * * * * * * * * * * * //</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div><div class="line"><a name="l01482"></a><span class="lineno"><a class="line" href="a02484.html#ad52fafb07b65b15def16c40bd6cdd12d"> 1482</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a02484.html#ad52fafb07b65b15def16c40bd6cdd12d">Foam::surfaceFeatures::operator=</a>(<span class="keyword">const</span> <a class="code" href="a02484.html">surfaceFeatures</a>&amp; rhs)</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;{</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">// Check for assignment to self</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">this</span> == &amp;rhs)</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    {</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <a class="code" href="a07738.html#af2484eff8084de37cba5d9d7a00fb293">FatalErrorInFunction</a></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Attempted assignment to self&quot;</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            &lt;&lt; <a class="code" href="a10742.html#a447107a607d03e417307c203fa5fb44b">abort</a>(<a class="code" href="a10742.html#ac50d206700f3f71855dd30c9a076de43">FatalError</a>);</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    }</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordflow">if</span> (&amp;surf_ != &amp;rhs.<a class="code" href="a02484.html#ad324bdf983edf0e82844ade150fdca87">surface</a>())</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    {</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <a class="code" href="a07738.html#af2484eff8084de37cba5d9d7a00fb293">FatalErrorInFunction</a></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Operating on different surfaces&quot;</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            &lt;&lt; <a class="code" href="a10742.html#a447107a607d03e417307c203fa5fb44b">abort</a>(<a class="code" href="a10742.html#ac50d206700f3f71855dd30c9a076de43">FatalError</a>);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    }</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    featurePoints_ = rhs.<a class="code" href="a02484.html#a2d6d00568cd19951e891edac858d4934">featurePoints</a>();</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    featureEdges_ = rhs.<a class="code" href="a02484.html#abfe7daa57d1d2e25b24113d4b14bc1b5">featureEdges</a>();</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    externalStart_ = rhs.<a class="code" href="a02484.html#acf980a241a42c3692a73251bc9432e51">externalStart</a>();</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    internalStart_ = rhs.<a class="code" href="a02484.html#aeab3e4cd8dfcb1cf7007364dc9c43647">internalStart</a>();</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;}</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">// ************************************************************************* //</span></div><div class="ttc" id="a00988_html_a540580a296c0ff351686ceb4f27b6fe6"><div class="ttname"><a href="a00988.html#a540580a296c0ff351686ceb4f27b6fe6">Foam::HashTableCore::end</a></div><div class="ttdeci">static iteratorEnd end()</div><div class="ttdoc">iteratorEnd set to beyond the end of any HashTable </div><div class="ttdef"><b>Definition:</b> <a href="a07589_source.html#l00106">HashTable.H:106</a></div></div>
<div class="ttc" id="a07738_html_af2484eff8084de37cba5d9d7a00fb293"><div class="ttname"><a href="a07738.html#af2484eff8084de37cba5d9d7a00fb293">FatalErrorInFunction</a></div><div class="ttdeci">#define FatalErrorInFunction</div><div class="ttdoc">Report an error message using Foam::FatalError. </div><div class="ttdef"><b>Definition:</b> <a href="a07738_source.html#l00319">error.H:319</a></div></div>
<div class="ttc" id="a00605_html_a7b67b42af715604376ad63a681dee6d8"><div class="ttname"><a href="a00605.html#a7b67b42af715604376ad63a681dee6d8">Foam::DynamicList::append</a></div><div class="ttdeci">DynamicList&lt; T, SizeInc, SizeMult, SizeDiv &gt; &amp; append(const T &amp;)</div><div class="ttdoc">Append an element at the end of the list. </div><div class="ttdef"><b>Definition:</b> <a href="a07642_source.html#l00310">DynamicListI.H:310</a></div></div>
<div class="ttc" id="a01367_html_a399dd2bf0d9a32016717dc90126f016b"><div class="ttname"><a href="a01367.html#a399dd2bf0d9a32016717dc90126f016b">Foam::List::append</a></div><div class="ttdeci">void append(const T &amp;)</div><div class="ttdoc">Append an element at the end of the list. </div><div class="ttdef"><b>Definition:</b> <a href="a07653_source.html#l00097">ListI.H:97</a></div></div>
<div class="ttc" id="a10742_html_af706f965be4d1457b0f1e7fade1c0118"><div class="ttname"><a href="a10742.html#af706f965be4d1457b0f1e7fade1c0118">Foam::degToRad</a></div><div class="ttdeci">scalar degToRad(const scalar deg)</div><div class="ttdoc">Conversion from degrees to radians. </div><div class="ttdef"><b>Definition:</b> <a href="a08195_source.html#l00045">unitConversion.H:45</a></div></div>
<div class="ttc" id="a01404_html"><div class="ttname"><a href="a01404.html">Foam::Map</a></div><div class="ttdoc">A HashTable to objects of type &lt;T&gt; with a label key. </div><div class="ttdef"><b>Definition:</b> <a href="a07593_source.html#l00049">Map.H:49</a></div></div>
<div class="ttc" id="a02484_html_a64c6ffeea50313e7c5f4ab5a651d690d"><div class="ttname"><a href="a02484.html#a64c6ffeea50313e7c5f4ab5a651d690d">Foam::surfaceFeatures::selectFeatureEdges</a></div><div class="ttdeci">labelList selectFeatureEdges(const bool regionEdges, const bool externalEdges, const bool internalEdges) const </div><div class="ttdoc">Helper function: select a subset of featureEdges_. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l00635">surfaceFeatures.C:635</a></div></div>
<div class="ttc" id="a00605_html_a3769bf93f15609625d62b693c566bcd1"><div class="ttname"><a href="a00605.html#a3769bf93f15609625d62b693c566bcd1">Foam::DynamicList::setCapacity</a></div><div class="ttdeci">void setCapacity(const label)</div><div class="ttdoc">Alter the size of the underlying storage. </div><div class="ttdef"><b>Definition:</b> <a href="a07642_source.html#l00109">DynamicListI.H:109</a></div></div>
<div class="ttc" id="a10742_html_ac993e906cf2774ae77e666bc24e81733"><div class="ttname"><a href="a10742.html#ac993e906cf2774ae77e666bc24e81733">Foam::max</a></div><div class="ttdeci">dimensioned&lt; Type &gt; max(const dimensioned&lt; Type &gt; &amp;, const dimensioned&lt; Type &gt; &amp;)</div></div>
<div class="ttc" id="a02741_html_aef07c02ea1c27bdb5906043b399e0ff0"><div class="ttname"><a href="a02741.html#aef07c02ea1c27bdb5906043b399e0ff0">Foam::UList::last</a></div><div class="ttdeci">T &amp; last()</div><div class="ttdoc">Return the last element of the list. </div><div class="ttdef"><b>Definition:</b> <a href="a07684_source.html#l00131">UListI.H:131</a></div></div>
<div class="ttc" id="a02484_html_aeab3e4cd8dfcb1cf7007364dc9c43647"><div class="ttname"><a href="a02484.html#aeab3e4cd8dfcb1cf7007364dc9c43647">Foam::surfaceFeatures::internalStart</a></div><div class="ttdeci">label internalStart() const </div><div class="ttdoc">Start of internal edges. </div><div class="ttdef"><b>Definition:</b> <a href="a07501_source.html#l00251">surfaceFeatures.H:251</a></div></div>
<div class="ttc" id="a02797_html"><div class="ttname"><a href="a02797.html">Foam::Vector&lt; scalar &gt;</a></div></div>
<div class="ttc" id="a00756_html"><div class="ttname"><a href="a00756.html">Foam::Field&lt; vector &gt;</a></div></div>
<div class="ttc" id="a10742_html_a2e0318a3a140a9ee64174b45fbfd45f0"><div class="ttname"><a href="a10742.html#a2e0318a3a140a9ee64174b45fbfd45f0">Foam::linePointRef</a></div><div class="ttdeci">line&lt; point, const point &amp; &gt; linePointRef</div><div class="ttdoc">Line using referred points. </div><div class="ttdef"><b>Definition:</b> <a href="a08776_source.html#l00045">linePointRef.H:45</a></div></div>
<div class="ttc" id="a01332_html_aa827cbb8a8c37bb9d4e1ef7eaa234792"><div class="ttname"><a href="a01332.html#aa827cbb8a8c37bb9d4e1ef7eaa234792">Foam::line::centre</a></div><div class="ttdeci">Point centre() const </div><div class="ttdoc">Return centre (centroid) </div><div class="ttdef"><b>Definition:</b> <a href="a08774_source.html#l00073">lineI.H:73</a></div></div>
<div class="ttc" id="a10742_html_a1cb143a027019075df276006651d7048"><div class="ttname"><a href="a10742.html#a1cb143a027019075df276006651d7048">Foam::labelList</a></div><div class="ttdeci">List&lt; label &gt; labelList</div><div class="ttdoc">A List of labels. </div><div class="ttdef"><b>Definition:</b> <a href="a08896_source.html#l00056">labelList.H:56</a></div></div>
<div class="ttc" id="a10742_html_af62a190ccee72226ab0f985f42cb7b4e"><div class="ttname"><a href="a10742.html#af62a190ccee72226ab0f985f42cb7b4e">Foam::Warning</a></div><div class="ttdeci">messageStream Warning</div></div>
<div class="ttc" id="a01890_html_a6c68a01f71e2d6a820e0f0e3540aff0f"><div class="ttname"><a href="a01890.html#a6c68a01f71e2d6a820e0f0e3540aff0f">Foam::PointIndexHit::rawPoint</a></div><div class="ttdeci">const Point &amp; rawPoint() const </div><div class="ttdoc">Return point with no checking. </div><div class="ttdef"><b>Definition:</b> <a href="a08783_source.html#l00143">PointIndexHit.H:143</a></div></div>
<div class="ttc" id="a01977_html_a180aa335ba66b3224df33de8eb29b3bf"><div class="ttname"><a href="a01977.html#a180aa335ba66b3224df33de8eb29b3bf">Foam::PrimitivePatch::localPoints</a></div><div class="ttdeci">const Field&lt; PointType &gt; &amp; localPoints() const </div><div class="ttdoc">Return pointField of points in patch. </div><div class="ttdef"><b>Definition:</b> <a href="a08755_source.html#l00448">PrimitivePatch.C:448</a></div></div>
<div class="ttc" id="a10742_html_a929da2a3fdcf3dacbbe0487d3a330dae"><div class="ttname"><a href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">Foam::mag</a></div><div class="ttdeci">dimensioned&lt; scalar &gt; mag(const dimensioned&lt; Type &gt; &amp;)</div></div>
<div class="ttc" id="a02484_html_ad0730de914a7db6da70faf38494a489d"><div class="ttname"><a href="a02484.html#ad0730de914a7db6da70faf38494a489d">Foam::surfaceFeatures::nearestEdges</a></div><div class="ttdeci">Map&lt; pointIndexHit &gt; nearestEdges(const labelList &amp;selectedEdges, const edgeList &amp;sampleEdges, const labelList &amp;selectedSampleEdges, const pointField &amp;samplePoints, const scalarField &amp;sampleDist, const scalarField &amp;maxDistSqr, const scalar minSampleDist=0.1) const </div><div class="ttdoc">Like nearestSamples but now gets nearest point on. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l01133">surfaceFeatures.C:1133</a></div></div>
<div class="ttc" id="a02484_html_abfe7daa57d1d2e25b24113d4b14bc1b5"><div class="ttname"><a href="a02484.html#abfe7daa57d1d2e25b24113d4b14bc1b5">Foam::surfaceFeatures::featureEdges</a></div><div class="ttdeci">const labelList &amp; featureEdges() const </div><div class="ttdoc">Return feature edge list. </div><div class="ttdef"><b>Definition:</b> <a href="a07501_source.html#l00239">surfaceFeatures.H:239</a></div></div>
<div class="ttc" id="a01367_html_ac8bb3912a3ce86b15842e79d0b421204"><div class="ttname"><a href="a01367.html#ac8bb3912a3ce86b15842e79d0b421204">Foam::List::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clear the list, i.e. set size to zero. </div><div class="ttdef"><b>Definition:</b> <a href="a07651_source.html#l00379">List.C:379</a></div></div>
<div class="ttc" id="a01977_html_ab456054a1e7e1a07261799f50167916f"><div class="ttname"><a href="a01977.html#ab456054a1e7e1a07261799f50167916f">Foam::PrimitivePatch::edgeFaces</a></div><div class="ttdeci">const labelListList &amp; edgeFaces() const </div><div class="ttdoc">Return edge-face addressing. </div><div class="ttdef"><b>Definition:</b> <a href="a08755_source.html#l00308">PrimitivePatch.C:308</a></div></div>
<div class="ttc" id="a02484_html_a2d6d00568cd19951e891edac858d4934"><div class="ttname"><a href="a02484.html#a2d6d00568cd19951e891edac858d4934">Foam::surfaceFeatures::featurePoints</a></div><div class="ttdeci">const labelList &amp; featurePoints() const </div><div class="ttdoc">Return feature point list. </div><div class="ttdef"><b>Definition:</b> <a href="a07501_source.html#l00233">surfaceFeatures.H:233</a></div></div>
<div class="ttc" id="a01977_html_a1db9478309c639504a743b7b194226f4"><div class="ttname"><a href="a01977.html#a1db9478309c639504a743b7b194226f4">Foam::PrimitivePatch::nEdges</a></div><div class="ttdeci">label nEdges() const </div><div class="ttdoc">Return number of edges in patch. </div><div class="ttdef"><b>Definition:</b> <a href="a08757_source.html#l00301">PrimitivePatch.H:301</a></div></div>
<div class="ttc" id="a07683_html_a1a02bffef961ee015f0e9b03d336c6a9"><div class="ttname"><a href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a></div><div class="ttdeci">#define forAll(list, i)</div><div class="ttdoc">Loop across all elements in list. </div><div class="ttdef"><b>Definition:</b> <a href="a07683_source.html#l00406">UList.H:406</a></div></div>
<div class="ttc" id="a00613_html_ab53e2468b3b9d33c35dc8be5c6867e0f"><div class="ttname"><a href="a00613.html#ab53e2468b3b9d33c35dc8be5c6867e0f">Foam::edge::otherVertex</a></div><div class="ttdeci">label otherVertex(const label a) const </div><div class="ttdoc">Given one vertex, return the other. </div><div class="ttdef"><b>Definition:</b> <a href="a08536_source.html#l00103">edgeI.H:103</a></div></div>
<div class="ttc" id="a00605_html_a88964e734acd91f096c914d0cc5a6e75"><div class="ttname"><a href="a00605.html#a88964e734acd91f096c914d0cc5a6e75">Foam::DynamicList::shrink</a></div><div class="ttdeci">DynamicList&lt; T, SizeInc, SizeMult, SizeDiv &gt; &amp; shrink()</div><div class="ttdoc">Shrink the allocated space to the number of elements used. </div><div class="ttdef"><b>Definition:</b> <a href="a07642_source.html#l00258">DynamicListI.H:258</a></div></div>
<div class="ttc" id="a02484_html_a1886e792c1c3df0142ae87adadbd7aef"><div class="ttname"><a href="a02484.html#a1886e792c1c3df0142ae87adadbd7aef">Foam::surfaceFeatures::nearestFeatEdge</a></div><div class="ttdeci">void nearestFeatEdge(const edgeList &amp;edges, const pointField &amp;points, scalar searchSpanSqr, labelList &amp;edgeLabel) const </div><div class="ttdoc">Find nearest feature edge to each surface edge. Uses the. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l01420">surfaceFeatures.C:1420</a></div></div>
<div class="ttc" id="a02484_html_acf980a241a42c3692a73251bc9432e51"><div class="ttname"><a href="a02484.html#acf980a241a42c3692a73251bc9432e51">Foam::surfaceFeatures::externalStart</a></div><div class="ttdeci">label externalStart() const </div><div class="ttdoc">Start of external edges. </div><div class="ttdef"><b>Definition:</b> <a href="a07501_source.html#l00245">surfaceFeatures.H:245</a></div></div>
<div class="ttc" id="a01367_html_a8a5f6fa29bd4b500caf186f60245b384"><div class="ttname"><a href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">Foam::List::size</a></div><div class="ttdeci">void size(const label)</div><div class="ttdoc">Override size to be inconsistent with allocated storage. </div><div class="ttdef"><b>Definition:</b> <a href="a07653_source.html#l00076">ListI.H:76</a></div></div>
<div class="ttc" id="a10742_html_a277dc11c581d53826ab5090b08f3b17b"><div class="ttname"><a href="a10742.html#a277dc11c581d53826ab5090b08f3b17b">Foam::sqr</a></div><div class="ttdeci">dimensionedSymmTensor sqr(const dimensionedVector &amp;dv)</div><div class="ttdef"><b>Definition:</b> <a href="a07884_source.html#l00049">dimensionedSymmTensor.C:49</a></div></div>
<div class="ttc" id="a01742_html"><div class="ttname"><a href="a01742.html">Foam::Ostream</a></div><div class="ttdoc">An Ostream is an abstract base class for all output systems (streams, files, token lists...</div><div class="ttdef"><b>Definition:</b> <a href="a07798_source.html#l00053">Ostream.H:53</a></div></div>
<div class="ttc" id="a00987_html_a76b2c74ebd9f33fa9f76261b027ffc11"><div class="ttname"><a href="a00987.html#a76b2c74ebd9f33fa9f76261b027ffc11">Foam::HashTable::find</a></div><div class="ttdeci">iterator find(const Key &amp;)</div><div class="ttdoc">Find and return an iterator set at the hashedEntry. </div><div class="ttdef"><b>Definition:</b> <a href="a07588_source.html#l00138">HashTable.C:138</a></div></div>
<div class="ttc" id="a01488_html"><div class="ttname"><a href="a01488.html">Foam::midPoint</a></div><div class="ttdoc">Mid-point interpolation (weighting factors = 0.5) scheme class. </div><div class="ttdef"><b>Definition:</b> <a href="a06132_source.html#l00050">midPoint.H:50</a></div></div>
<div class="ttc" id="a07783_html"><div class="ttname"><a href="a07783.html">IFstream.H</a></div></div>
<div class="ttc" id="a08195_html"><div class="ttname"><a href="a08195.html">unitConversion.H</a></div><div class="ttdoc">Unit conversion functions. </div></div>
<div class="ttc" id="a07281_html"><div class="ttname"><a href="a07281.html">treeDataPoint.H</a></div></div>
<div class="ttc" id="a07317_html"><div class="ttname"><a href="a07317.html">meshTools.H</a></div></div>
<div class="ttc" id="a10742_html_a29558ed008131ebedb6c3b965e9f4175"><div class="ttname"><a href="a10742.html#a29558ed008131ebedb6c3b965e9f4175">Foam::pointIndexHit</a></div><div class="ttdeci">PointIndexHit&lt; point &gt; pointIndexHit</div><div class="ttdef"><b>Definition:</b> <a href="a08782_source.html#l00042">pointIndexHit.H:42</a></div></div>
<div class="ttc" id="a10742_html_a9907f9d4272b10c75ac87c1679b77c24"><div class="ttname"><a href="a10742.html#a9907f9d4272b10c75ac87c1679b77c24">Foam::defineTypeNameAndDebug</a></div><div class="ttdeci">defineTypeNameAndDebug(combustionModel, 0)</div></div>
<div class="ttc" id="a01890_html_a0c448cd4b96e9ea9ba38c62c019a8bce"><div class="ttname"><a href="a01890.html#a0c448cd4b96e9ea9ba38c62c019a8bce">Foam::PointIndexHit::hitPoint</a></div><div class="ttdeci">const Point &amp; hitPoint() const </div><div class="ttdoc">Return hit point. </div><div class="ttdef"><b>Definition:</b> <a href="a08783_source.html#l00117">PointIndexHit.H:117</a></div></div>
<div class="ttc" id="a02484_html_a9bf24153af0cf5754b35c9cae8de8ce2ac157bdf0b85a40d2619cbc8bc1ae5fe2"><div class="ttname"><a href="a02484.html#a9bf24153af0cf5754b35c9cae8de8ce2ac157bdf0b85a40d2619cbc8bc1ae5fe2">Foam::surfaceFeatures::NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="a07501_source.html#l00074">surfaceFeatures.H:74</a></div></div>
<div class="ttc" id="a02484_html_a05b6a62c91ca3d68db42ba635ff1f307"><div class="ttname"><a href="a02484.html#a05b6a62c91ca3d68db42ba635ff1f307">Foam::surfaceFeatures::nearestSamples</a></div><div class="ttdeci">Map&lt; label &gt; nearestSamples(const labelList &amp;selectedPoints, const pointField &amp;samples, const scalarField &amp;maxDistSqr) const </div><div class="ttdoc">Find nearest sample for selected surface points. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l00913">surfaceFeatures.C:913</a></div></div>
<div class="ttc" id="a02484_html_a1d250089d155faf127da07f5484f0370"><div class="ttname"><a href="a02484.html#a1d250089d155faf127da07f5484f0370">Foam::surfaceFeatures::surfaceFeatures</a></div><div class="ttdeci">surfaceFeatures(const triSurface &amp;)</div><div class="ttdoc">Construct from surface. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l00448">surfaceFeatures.C:448</a></div></div>
<div class="ttc" id="a00156_html_a7264596c8566f5168aa2f5e795c884f4"><div class="ttname"><a href="a00156.html#a7264596c8566f5168aa2f5e795c884f4">Foam::boundBox::inflate</a></div><div class="ttdeci">void inflate(const scalar s)</div><div class="ttdoc">Inflate box by factor*mag(span) in all dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="a08469_source.html#l00210">boundBox.C:210</a></div></div>
<div class="ttc" id="a04326_html_ab318caaec810447a252e6134c88a7a77"><div class="ttname"><a href="a04326.html#ab318caaec810447a252e6134c88a7a77">sf</a></div><div class="ttdeci">volScalarField sf(fieldObject, mesh)</div></div>
<div class="ttc" id="a01367_html"><div class="ttname"><a href="a01367.html">Foam::List</a></div><div class="ttdoc">A 1D array of objects of type &lt;T&gt;, where the size of the vector is known and used for subscript bound...</div><div class="ttdef"><b>Definition:</b> <a href="a07589_source.html#l00059">HashTable.H:59</a></div></div>
<div class="ttc" id="a01709_html_acd3da3556711337d571c60cf9ffb91cc"><div class="ttname"><a href="a01709.html#acd3da3556711337d571c60cf9ffb91cc">Foam::OFstream::name</a></div><div class="ttdeci">const fileName &amp; name() const </div><div class="ttdoc">Return the name of the stream. </div><div class="ttdef"><b>Definition:</b> <a href="a07785_source.html#l00118">OFstream.H:118</a></div></div>
<div class="ttc" id="a02679_html"><div class="ttname"><a href="a02679.html">Foam::treeDataEdge</a></div><div class="ttdoc">Holds data for octree to work on an edges subset. </div><div class="ttdef"><b>Definition:</b> <a href="a07277_source.html#l00053">treeDataEdge.H:53</a></div></div>
<div class="ttc" id="a10742_html_aa37b155edbb26030ea38158b7483b0ba"><div class="ttname"><a href="a10742.html#aa37b155edbb26030ea38158b7483b0ba">Foam::pointHit</a></div><div class="ttdeci">PointHit&lt; point &gt; pointHit</div><div class="ttdef"><b>Definition:</b> <a href="a08779_source.html#l00041">pointHit.H:41</a></div></div>
<div class="ttc" id="a00613_html_aefea0e4a074dd0ba02419922ed063888"><div class="ttname"><a href="a00613.html#aefea0e4a074dd0ba02419922ed063888">Foam::edge::line</a></div><div class="ttdeci">linePointRef line(const pointField &amp;) const </div><div class="ttdoc">Return edge line. </div><div class="ttdef"><b>Definition:</b> <a href="a08536_source.html#l00169">edgeI.H:169</a></div></div>
<div class="ttc" id="a02484_html"><div class="ttname"><a href="a02484.html">Foam::surfaceFeatures</a></div><div class="ttdoc">Holds feature edges/points of surface. </div><div class="ttdef"><b>Definition:</b> <a href="a07501_source.html#l00068">surfaceFeatures.H:68</a></div></div>
<div class="ttc" id="a00613_html_a9c85e25fb010469f9d04cd70d9250419"><div class="ttname"><a href="a00613.html#a9c85e25fb010469f9d04cd70d9250419">Foam::edge::vec</a></div><div class="ttdeci">vector vec(const pointField &amp;) const </div><div class="ttdoc">Return the vector (end - start) </div><div class="ttdef"><b>Definition:</b> <a href="a08536_source.html#l00157">edgeI.H:157</a></div></div>
<div class="ttc" id="a02484_html_ac9d88c671fbfe12e0526038fb054c11d"><div class="ttname"><a href="a02484.html#ac9d88c671fbfe12e0526038fb054c11d">Foam::surfaceFeatures::nearestSurfEdge</a></div><div class="ttdeci">void nearestSurfEdge(const labelList &amp;selectedEdges, const pointField &amp;samples, scalar searchSpanSqr, labelList &amp;edgeLabel, labelList &amp;edgeEndPoint, pointField &amp;edgePoint) const </div><div class="ttdoc">Find nearest surface edge (out of selectedEdges) for. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l01284">surfaceFeatures.C:1284</a></div></div>
<div class="ttc" id="a10742_html_a643590f4015338d12714af03d61a0ac9"><div class="ttname"><a href="a10742.html#a643590f4015338d12714af03d61a0ac9">Foam::point</a></div><div class="ttdeci">vector point</div><div class="ttdoc">Point is a vector. </div><div class="ttdef"><b>Definition:</b> <a href="a08788_source.html#l00041">point.H:41</a></div></div>
<div class="ttc" id="a10742_html_a2db8fe02a0d3909e9351bb4275b23ce4"><div class="ttname"><a href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">Foam::endl</a></div><div class="ttdeci">Ostream &amp; endl(Ostream &amp;os)</div><div class="ttdoc">Add newline and flush stream. </div><div class="ttdef"><b>Definition:</b> <a href="a07798_source.html#l00251">Ostream.H:251</a></div></div>
<div class="ttc" id="a08540_html"><div class="ttname"><a href="a08540.html">EdgeMap.H</a></div></div>
<div class="ttc" id="a02484_html_a104ad1549afa89b0b6ae590fda99816a"><div class="ttname"><a href="a02484.html#a104ad1549afa89b0b6ae590fda99816a">Foam::surfaceFeatures::findFeatures</a></div><div class="ttdeci">void findFeatures(const scalar includedAngle, const bool geometricTestOnly)</div><div class="ttdoc">Find feature edges using provided included angle. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l00678">surfaceFeatures.C:678</a></div></div>
<div class="ttc" id="a00613_html_a8ed0e876210c2c116b5694307a830518"><div class="ttname"><a href="a00613.html#a8ed0e876210c2c116b5694307a830518">Foam::edge::end</a></div><div class="ttdeci">label end() const </div><div class="ttdoc">Return end vertex label. </div><div class="ttdef"><b>Definition:</b> <a href="a08536_source.html#l00092">edgeI.H:92</a></div></div>
<div class="ttc" id="a04287_html_a6d6b99210a64ad23792eb7a3b0411c42"><div class="ttname"><a href="a04287.html#a6d6b99210a64ad23792eb7a3b0411c42">s</a></div><div class="ttdeci">gmvFile&lt;&lt; &quot;tracers &quot;&lt;&lt; particles.size()&lt;&lt; nl;forAllConstIter(Cloud&lt; passiveParticle &gt;, particles, iter){gmvFile&lt;&lt; iter().position().x()&lt;&lt; &quot; &quot;;}gmvFile&lt;&lt; nl;forAllConstIter(Cloud&lt; passiveParticle &gt;, particles, iter){gmvFile&lt;&lt; iter().position().y()&lt;&lt; &quot; &quot;;}gmvFile&lt;&lt; nl;forAllConstIter(Cloud&lt; passiveParticle &gt;, particles, iter){gmvFile&lt;&lt; iter().position().z()&lt;&lt; &quot; &quot;;}gmvFile&lt;&lt; nl;forAll(lagrangianScalarNames, i){word name=lagrangianScalarNames[i];IOField&lt; scalar &gt; s(IOobject(                                       name,                                       runTime.timeName(),                                       cloud::prefix,                                       mesh,                                       IOobject::MUST_READ,                                       IOobject::NO_WRITE                       ))</div></div>
<div class="ttc" id="a07557_html"><div class="ttname"><a href="a07557.html">indexedOctree.H</a></div></div>
<div class="ttc" id="a10742_html_a4517d680df5510934705011b30dcefa6"><div class="ttname"><a href="a10742.html#a4517d680df5510934705011b30dcefa6">Foam::sin</a></div><div class="ttdeci">dimensionedScalar sin(const dimensionedScalar &amp;ds)</div><div class="ttdef"><b>Definition:</b> <a href="a07879_source.html#l00255">dimensionedScalar.C:255</a></div></div>
<div class="ttc" id="a02966_html_ae21e2836509b0fa7f7cedf6493b11b09"><div class="ttname"><a href="a02966.html#ae21e2836509b0fa7f7cedf6493b11b09">forAllConstIter</a></div><div class="ttdeci">forAllConstIter(PtrDictionary&lt; phaseModel &gt;, mixture.phases(), phase)</div><div class="ttdef"><b>Definition:</b> <a href="a02966_source.html#l00029">pEqn.H:29</a></div></div>
<div class="ttc" id="a10742_html_aebb41a148f7cf44b63e12f69e487e49f"><div class="ttname"><a href="a10742.html#aebb41a148f7cf44b63e12f69e487e49f">Foam::cos</a></div><div class="ttdeci">dimensionedScalar cos(const dimensionedScalar &amp;ds)</div><div class="ttdef"><b>Definition:</b> <a href="a07879_source.html#l00256">dimensionedScalar.C:256</a></div></div>
<div class="ttc" id="a02484_html_a24a846546c009c971cd77d7d91983cbb"><div class="ttname"><a href="a02484.html#a24a846546c009c971cd77d7d91983cbb">Foam::surfaceFeatures::nRegionEdges</a></div><div class="ttdeci">label nRegionEdges() const </div><div class="ttdoc">Return number of region edges. </div><div class="ttdef"><b>Definition:</b> <a href="a07501_source.html#l00257">surfaceFeatures.H:257</a></div></div>
<div class="ttc" id="a00781_html"><div class="ttname"><a href="a00781.html">Foam::fileName</a></div><div class="ttdoc">A class for handling file names. </div><div class="ttdef"><b>Definition:</b> <a href="a08968_source.html#l00069">fileName.H:69</a></div></div>
<div class="ttc" id="a00617_html"><div class="ttname"><a href="a00617.html">Foam::EdgeMap&lt; label &gt;</a></div></div>
<div class="ttc" id="a02484_html_a7d604d80e6ec2b5d31c0e4e799f946fd"><div class="ttname"><a href="a02484.html#a7d604d80e6ec2b5d31c0e4e799f946fd">Foam::surfaceFeatures::toStatus</a></div><div class="ttdeci">List&lt; edgeStatus &gt; toStatus() const </div><div class="ttdoc">From member feature edges to status per edge. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l00093">surfaceFeatures.C:93</a></div></div>
<div class="ttc" id="a01709_html"><div class="ttname"><a href="a01709.html">Foam::OFstream</a></div><div class="ttdoc">Output to file stream. </div><div class="ttdef"><b>Definition:</b> <a href="a07785_source.html#l00081">OFstream.H:81</a></div></div>
<div class="ttc" id="a01890_html"><div class="ttname"><a href="a01890.html">Foam::PointIndexHit</a></div><div class="ttdoc">This class describes the interaction of (usually) a face and a point. It carries the info of a succes...</div><div class="ttdef"><b>Definition:</b> <a href="a08783_source.html#l00053">PointIndexHit.H:53</a></div></div>
<div class="ttc" id="a00605_html"><div class="ttname"><a href="a00605.html">Foam::DynamicList&lt; label &gt;</a></div></div>
<div class="ttc" id="a00613_html_ac47b383852677ce70d239fc1c06b500d"><div class="ttname"><a href="a00613.html#ac47b383852677ce70d239fc1c06b500d">Foam::edge::mag</a></div><div class="ttdeci">scalar mag(const pointField &amp;) const </div><div class="ttdoc">Return scalar magnitude. </div><div class="ttdef"><b>Definition:</b> <a href="a08536_source.html#l00163">edgeI.H:163</a></div></div>
<div class="ttc" id="a00987_html_a5eee1e0e199ad59b9cb3916cd42156e0"><div class="ttname"><a href="a00987.html#a5eee1e0e199ad59b9cb3916cd42156e0">Foam::HashTable&lt; T, edge, Hash&lt; edge &gt; &gt;::insert</a></div><div class="ttdeci">bool insert(const edge &amp;, const T &amp;newElmt)</div><div class="ttdoc">Insert a new hashedEntry. </div></div>
<div class="ttc" id="a07277_html"><div class="ttname"><a href="a07277.html">treeDataEdge.H</a></div></div>
<div class="ttc" id="a01977_html_aae82d34fe433288eb6b1f9dea53675c8"><div class="ttname"><a href="a01977.html#aae82d34fe433288eb6b1f9dea53675c8">Foam::PrimitivePatch::edges</a></div><div class="ttdeci">const edgeList &amp; edges() const </div><div class="ttdoc">Return list of edges, address into LOCAL point list. </div><div class="ttdef"><b>Definition:</b> <a href="a08755_source.html#l00228">PrimitivePatch.C:228</a></div></div>
<div class="ttc" id="a01057_html_af955c64dcfefdc4ac1d969621016d443"><div class="ttname"><a href="a01057.html#af955c64dcfefdc4ac1d969621016d443">Foam::indexedOctree::bb</a></div><div class="ttdeci">const treeBoundBox &amp; bb() const </div><div class="ttdoc">Top bounding box. </div><div class="ttdef"><b>Definition:</b> <a href="a07557_source.html#l00468">indexedOctree.H:468</a></div></div>
<div class="ttc" id="a10742_html_a36af96cb841435845fffb4fe69208490"><div class="ttname"><a href="a10742.html#a36af96cb841435845fffb4fe69208490">Foam::identity</a></div><div class="ttdeci">labelList identity(const label len)</div><div class="ttdoc">Create identity map (map[i] == i) of given length. </div><div class="ttdef"><b>Definition:</b> <a href="a07658_source.html#l00104">ListOps.C:104</a></div></div>
<div class="ttc" id="a10742_html_abb09fbcf651d29208982dd7a601b606f"><div class="ttname"><a href="a10742.html#abb09fbcf651d29208982dd7a601b606f">Foam::readLabel</a></div><div class="ttdeci">label readLabel(Istream &amp;is)</div><div class="ttdef"><b>Definition:</b> <a href="a08892_source.html#l00064">label.H:64</a></div></div>
<div class="ttc" id="a02484_html_af640d0750bcc401bc012c69e60b809a8"><div class="ttname"><a href="a02484.html#af640d0750bcc401bc012c69e60b809a8">Foam::surfaceFeatures::trimFeatures</a></div><div class="ttdeci">labelList trimFeatures(const scalar minLen, const label minElems, const scalar includedAngle)</div><div class="ttdoc">Delete small sets of edges. Edges are stringed up and any. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l00703">surfaceFeatures.C:703</a></div></div>
<div class="ttc" id="a10742_html_a447107a607d03e417307c203fa5fb44b"><div class="ttname"><a href="a10742.html#a447107a607d03e417307c203fa5fb44b">Foam::abort</a></div><div class="ttdeci">errorManip&lt; error &gt; abort(error &amp;err)</div><div class="ttdef"><b>Definition:</b> <a href="a07739_source.html#l00131">errorManip.H:131</a></div></div>
<div class="ttc" id="a00525_html"><div class="ttname"><a href="a00525.html">Foam::dictionary</a></div><div class="ttdoc">A list of keyword definitions, which are a keyword followed by any number of values (e...</div><div class="ttdef"><b>Definition:</b> <a href="a07698_source.html#l00137">dictionary.H:137</a></div></div>
<div class="ttc" id="a01034_html"><div class="ttname"><a href="a01034.html">Foam::IFstream</a></div><div class="ttdoc">Input from file stream. </div><div class="ttdef"><b>Definition:</b> <a href="a07783_source.html#l00081">IFstream.H:81</a></div></div>
<div class="ttc" id="a00613_html"><div class="ttname"><a href="a00613.html">Foam::edge</a></div><div class="ttdoc">An edge is a list of two point labels. The functionality it provides supports the discretisation on a...</div><div class="ttdef"><b>Definition:</b> <a href="a08535_source.html#l00058">edge.H:58</a></div></div>
<div class="ttc" id="a02681_html"><div class="ttname"><a href="a02681.html">Foam::treeDataPoint</a></div><div class="ttdoc">Holds (reference to) pointField. Encapsulation of data needed for octree searches. Used for searching for nearest point. No bounding boxes around points. Only overlaps and calcNearest are implemented, rest makes little sense. </div><div class="ttdef"><b>Definition:</b> <a href="a07281_source.html#l00059">treeDataPoint.H:59</a></div></div>
<div class="ttc" id="a01332_html"><div class="ttname"><a href="a01332.html">Foam::line</a></div><div class="ttdoc">A line primitive. </div><div class="ttdef"><b>Definition:</b> <a href="a08773_source.html#l00056">line.H:56</a></div></div>
<div class="ttc" id="a07785_html"><div class="ttname"><a href="a07785.html">OFstream.H</a></div></div>
<div class="ttc" id="a10742_html"><div class="ttname"><a href="a10742.html">Foam</a></div><div class="ttdoc">Namespace for OpenFOAM. </div><div class="ttdef"><b>Definition:</b> <a href="a04634_source.html#l00030">combustionModel.C:30</a></div></div>
<div class="ttc" id="a01367_html_aedb985ffeaf1bdbfeccc2a8730405703"><div class="ttname"><a href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">Foam::List::setSize</a></div><div class="ttdeci">void setSize(const label)</div><div class="ttdoc">Reset size of List. </div><div class="ttdef"><b>Definition:</b> <a href="a07651_source.html#l00318">List.C:318</a></div></div>
<div class="ttc" id="a10742_html_a4225a7492f7d468ad5b985282c8ee7b1"><div class="ttname"><a href="a10742.html#a4225a7492f7d468ad5b985282c8ee7b1">Foam::e</a></div><div class="ttdeci">const double e</div><div class="ttdoc">Elementary charge. </div><div class="ttdef"><b>Definition:</b> <a href="a08939_source.html#l00078">doubleFloat.H:78</a></div></div>
<div class="ttc" id="a02484_html_af77027c10b89b764f28cf777c66c4be6"><div class="ttname"><a href="a02484.html#af77027c10b89b764f28cf777c66c4be6">Foam::surfaceFeatures::writeDict</a></div><div class="ttdeci">void writeDict(Ostream &amp;) const </div><div class="ttdoc">Write as dictionary. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l00836">surfaceFeatures.C:836</a></div></div>
<div class="ttc" id="a00525_html_a4a8c5a25ca68b97e8408d4016287b5e2"><div class="ttname"><a href="a00525.html#a4a8c5a25ca68b97e8408d4016287b5e2">Foam::dictionary::write</a></div><div class="ttdeci">void write(Ostream &amp;, const bool subDict=true) const </div><div class="ttdoc">Write dictionary, normally with sub-dictionary formatting. </div><div class="ttdef"><b>Definition:</b> <a href="a07702_source.html#l00173">dictionaryIO.C:173</a></div></div>
<div class="ttc" id="a02484_html_ad324bdf983edf0e82844ade150fdca87"><div class="ttname"><a href="a02484.html#ad324bdf983edf0e82844ade150fdca87">Foam::surfaceFeatures::surface</a></div><div class="ttdeci">const triSurface &amp; surface() const </div><div class="ttdef"><b>Definition:</b> <a href="a07501_source.html#l00227">surfaceFeatures.H:227</a></div></div>
<div class="ttc" id="a00613_html_ae686335a8e426b97037d6845043b7151"><div class="ttname"><a href="a00613.html#ae686335a8e426b97037d6845043b7151">Foam::edge::centre</a></div><div class="ttdeci">point centre(const pointField &amp;) const </div><div class="ttdoc">Return centre (centroid) </div><div class="ttdef"><b>Definition:</b> <a href="a08536_source.html#l00151">edgeI.H:151</a></div></div>
<div class="ttc" id="a10742_html_ac50d206700f3f71855dd30c9a076de43"><div class="ttname"><a href="a10742.html#ac50d206700f3f71855dd30c9a076de43">Foam::FatalError</a></div><div class="ttdeci">error FatalError</div></div>
<div class="ttc" id="a00525_html_a8baab402d653d6e789f67c57e23a5b59"><div class="ttname"><a href="a00525.html#a8baab402d653d6e789f67c57e23a5b59">Foam::dictionary::lookup</a></div><div class="ttdeci">ITstream &amp; lookup(const word &amp;, bool recursive=false, bool patternMatch=true) const </div><div class="ttdoc">Find and return an entry data stream. </div><div class="ttdef"><b>Definition:</b> <a href="a07697_source.html#l00451">dictionary.C:451</a></div></div>
<div class="ttc" id="a02484_html_a3ec4130a2f02e6be2ba97774910eb125"><div class="ttname"><a href="a02484.html#a3ec4130a2f02e6be2ba97774910eb125">Foam::surfaceFeatures::setFromStatus</a></div><div class="ttdeci">void setFromStatus(const List&lt; edgeStatus &gt; &amp;edgeStat, const scalar includedAngle)</div><div class="ttdoc">Set from status per edge. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l00122">surfaceFeatures.C:122</a></div></div>
<div class="ttc" id="a10742_html_a06ca7250d8e89caf05243ec094843642"><div class="ttname"><a href="a10742.html#a06ca7250d8e89caf05243ec094843642">Foam::exit</a></div><div class="ttdeci">errorManipArg&lt; error, int &gt; exit(error &amp;err, const int errNo=1)</div><div class="ttdef"><b>Definition:</b> <a href="a07739_source.html#l00124">errorManip.H:124</a></div></div>
<div class="ttc" id="a10742_html_a1bc01f0470f765b8c1e9e7d09b5754bf"><div class="ttname"><a href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Foam::Pout</a></div><div class="ttdeci">prefixOSstream Pout(cout,&quot;Pout&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="a07789_source.html#l00053">IOstreams.H:53</a></div></div>
<div class="ttc" id="a10742_html_ac16695f83f370df159eed19f92d095fb"><div class="ttname"><a href="a10742.html#ac16695f83f370df159eed19f92d095fb">Foam::findIndex</a></div><div class="ttdeci">label findIndex(const ListType &amp;, typename ListType::const_reference, const label start=0)</div><div class="ttdoc">Find first occurence of given element and return index,. </div></div>
<div class="ttc" id="a00525_html_ac2ddcab42322c8d8af5e5830ab4d431b"><div class="ttname"><a href="a00525.html#ac2ddcab42322c8d8af5e5830ab4d431b">Foam::dictionary::add</a></div><div class="ttdeci">bool add(entry *, bool mergeEntry=false)</div><div class="ttdoc">Add a new entry. </div><div class="ttdef"><b>Definition:</b> <a href="a07697_source.html#l00731">dictionary.C:731</a></div></div>
<div class="ttc" id="a01057_html"><div class="ttname"><a href="a01057.html">Foam::indexedOctree</a></div><div class="ttdoc">Non-pointer based hierarchical recursive searching. </div><div class="ttdef"><b>Definition:</b> <a href="a07277_source.html#l00047">treeDataEdge.H:47</a></div></div>
<div class="ttc" id="a01332_html_a5793126218bf0f619549fc69390a1b51"><div class="ttname"><a href="a01332.html#a5793126218bf0f619549fc69390a1b51">Foam::line::nearestDist</a></div><div class="ttdeci">PointHit&lt; Point &gt; nearestDist(const Point &amp;p) const </div><div class="ttdoc">Return nearest distance to line from a given point. </div><div class="ttdef"><b>Definition:</b> <a href="a08774_source.html#l00095">lineI.H:95</a></div></div>
<div class="ttc" id="a02484_html_a2ddc9381af9dfe17313e19d2035085f7"><div class="ttname"><a href="a02484.html#a2ddc9381af9dfe17313e19d2035085f7">Foam::surfaceFeatures::nExternalEdges</a></div><div class="ttdeci">label nExternalEdges() const </div><div class="ttdoc">Return number of external edges. </div><div class="ttdef"><b>Definition:</b> <a href="a07501_source.html#l00263">surfaceFeatures.H:263</a></div></div>
<div class="ttc" id="a02484_html_ad52fafb07b65b15def16c40bd6cdd12d"><div class="ttname"><a href="a02484.html#ad52fafb07b65b15def16c40bd6cdd12d">Foam::surfaceFeatures::operator=</a></div><div class="ttdeci">void operator=(const surfaceFeatures &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l01482">surfaceFeatures.C:1482</a></div></div>
<div class="ttc" id="a00613_html_a96b607a9a9baa575783b4af443ef613f"><div class="ttname"><a href="a00613.html#a96b607a9a9baa575783b4af443ef613f">Foam::edge::start</a></div><div class="ttdeci">label start() const </div><div class="ttdoc">Return start vertex label. </div><div class="ttdef"><b>Definition:</b> <a href="a08536_source.html#l00081">edgeI.H:81</a></div></div>
<div class="ttc" id="a01890_html_ad963d38a624b8bf8b37c210109dba03c"><div class="ttname"><a href="a01890.html#ad963d38a624b8bf8b37c210109dba03c">Foam::PointIndexHit::hit</a></div><div class="ttdeci">bool hit() const </div><div class="ttdoc">Is there a hit. </div><div class="ttdef"><b>Definition:</b> <a href="a08783_source.html#l00105">PointIndexHit.H:105</a></div></div>
<div class="ttc" id="a10742_html_ae6fff2c6981e6d9618aa5038e69def6e"><div class="ttname"><a href="a10742.html#ae6fff2c6981e6d9618aa5038e69def6e">Foam::magSqr</a></div><div class="ttdeci">dimensioned&lt; scalar &gt; magSqr(const dimensioned&lt; Type &gt; &amp;)</div></div>
<div class="ttc" id="a01057_html_abd186b2cbd8c6def61dc033a4892b847"><div class="ttname"><a href="a01057.html#abd186b2cbd8c6def61dc033a4892b847">Foam::indexedOctree::shapes</a></div><div class="ttdeci">const Type &amp; shapes() const </div><div class="ttdoc">Reference to shape. </div><div class="ttdef"><b>Definition:</b> <a href="a07557_source.html#l00449">indexedOctree.H:449</a></div></div>
<div class="ttc" id="a07501_html"><div class="ttname"><a href="a07501.html">surfaceFeatures.H</a></div></div>
<div class="ttc" id="a10797_html_afd76c6ccc8ee4a5957f0232218167c17"><div class="ttname"><a href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">Foam::meshTools::writeOBJ</a></div><div class="ttdeci">void writeOBJ(Ostream &amp;os, const point &amp;pt)</div><div class="ttdoc">Write obj representation of point. </div><div class="ttdef"><b>Definition:</b> <a href="a07316_source.html#l00204">meshTools.C:204</a></div></div>
<div class="ttc" id="a02484_html_af78e21d23a56aa4355af14059f2b2770"><div class="ttname"><a href="a02484.html#af78e21d23a56aa4355af14059f2b2770">Foam::surfaceFeatures::writeObj</a></div><div class="ttdeci">void writeObj(const fileName &amp;prefix) const </div><div class="ttdoc">Write to separate OBJ files (region, external, internal edges,. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l00857">surfaceFeatures.C:857</a></div></div>
<div class="ttc" id="a01890_html_a7d1e8acadb27bd2b4e61457d47b71b6f"><div class="ttname"><a href="a01890.html#a7d1e8acadb27bd2b4e61457d47b71b6f">Foam::PointIndexHit::index</a></div><div class="ttdeci">label index() const </div><div class="ttdoc">Return index. </div><div class="ttdef"><b>Definition:</b> <a href="a08783_source.html#l00111">PointIndexHit.H:111</a></div></div>
<div class="ttc" id="a10506_html"><div class="ttname"><a href="a10506.html">triSurface.H</a></div></div>
<div class="ttc" id="a02797_html_a14e7470ec1c401bcd5b0330c73e5cc8a"><div class="ttname"><a href="a02797.html#a14e7470ec1c401bcd5b0330c73e5cc8a">Foam::Vector::centre</a></div><div class="ttdeci">const Vector&lt; Cmpt &gt; &amp; centre(const Foam::List&lt; Vector&lt; Cmpt &gt;&gt; &amp;) const </div><div class="ttdoc">Return *this (used for point which is a typedef to Vector&lt;scalar&gt;. </div><div class="ttdef"><b>Definition:</b> <a href="a09055_source.html#l00106">VectorI.H:106</a></div></div>
<div class="ttc" id="a02484_html_a3b322af5609b09f5d4f4b6fda11930df"><div class="ttname"><a href="a02484.html#a3b322af5609b09f5d4f4b6fda11930df">Foam::surfaceFeatures::nInternalEdges</a></div><div class="ttdeci">label nInternalEdges() const </div><div class="ttdoc">Return number of internal edges. </div><div class="ttdef"><b>Definition:</b> <a href="a07501_source.html#l00269">surfaceFeatures.H:269</a></div></div>
<div class="ttc" id="a02689_html"><div class="ttname"><a href="a02689.html">Foam::triSurface</a></div><div class="ttdoc">Triangulated surface description with patch information. </div><div class="ttdef"><b>Definition:</b> <a href="a10506_source.html#l00057">triSurface.H:57</a></div></div>
<div class="ttc" id="a10742_html_a22f45a3cb4f074e609f58ebaeef0ecf9"><div class="ttname"><a href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">Foam::label</a></div><div class="ttdeci">intWM_LABEL_SIZE_t label</div><div class="ttdoc">A label is an int32_t or int64_t as specified by the pre-processor macro WM_LABEL_SIZE. </div><div class="ttdef"><b>Definition:</b> <a href="a08892_source.html#l00059">label.H:59</a></div></div>
<div class="ttc" id="a02484_html_acdfdabbbb3782b001588a413f9f379e9"><div class="ttname"><a href="a02484.html#acdfdabbbb3782b001588a413f9f379e9">Foam::surfaceFeatures::write</a></div><div class="ttdeci">void write(const fileName &amp;fName) const </div><div class="ttdoc">Write as dictionary to file. </div><div class="ttdef"><b>Definition:</b> <a href="a07500_source.html#l00849">surfaceFeatures.C:849</a></div></div>
<div class="ttc" id="a10742_html_ae53117a9770efe95d2d01bb5cc2c99ef"><div class="ttname"><a href="a10742.html#ae53117a9770efe95d2d01bb5cc2c99ef">Foam::nl</a></div><div class="ttdeci">static const char nl</div><div class="ttdef"><b>Definition:</b> <a href="a07798_source.html#l00260">Ostream.H:260</a></div></div>
<div class="ttc" id="a08776_html"><div class="ttname"><a href="a08776.html">linePointRef.H</a></div></div>
<div class="ttc" id="a02677_html"><div class="ttname"><a href="a02677.html">Foam::treeBoundBox</a></div><div class="ttdoc">Standard boundBox + extra functionality for use in octree. </div><div class="ttdef"><b>Definition:</b> <a href="a08811_source.html#l00075">treeBoundBox.H:75</a></div></div>
</div><!-- fragment --></div><!-- contents -->
  <!-- end of doxygen-generated content -->
  </div> <!-- main -->
  <div class="footer">
    <p>
      Copyright&nbsp;&copy;&nbsp;2011-2013&nbsp;
      <a href="http://www.openfoam.org/about">OpenFOAM Foundation</a>
      |
      OPENFOAM&reg; is a registered
      <a href="http://www.openfoam.com/legal/trademark-policy.php">trademarks
      </a> of OpenCFD Ltd.
    </p>
    <p class="credits">
      Based on design by
      <a target="new" href="http://1234.info">1234.info</a>
      |
      Content generated by
      <a target="new" href="http://www.doxygen.org">doxygen</a>
    </p>
  </div>  <!-- footer -->
</div>  <!-- page-container -->
</body>
</html>
