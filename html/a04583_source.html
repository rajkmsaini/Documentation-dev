<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UFT-8"/>
<title> OpenFOAM&reg; Programmer's C++ documentation </title>
<!-- links -->
<link href="../OpenFOAMdocIcon.png" rel="icon" type="image/png" />
<link href="search/search.css" rel="stylesheet" type="text/css" />
<link href="../css/openfoam.css" rel="stylesheet" type="text/css" />
<script type="text/javaScript" src="search/search.js"></script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- meta info -->
<meta
    name="keywords"
    content="computational fluid dynamics, CFD, OpenFOAM, open source CFD, open source"
    />
</head>
<body>
<div class="page-container">
  <div class="header">
    <div class="header-top">
      <a class="sitelogo" href="http://www.openfoam.org" title="Home">
        <img class=left src="../css/img/OpenFOAMlogo.png">
      </a>
      <div class="sitename">
        <h1>
          <a href="http://foam.sourceforge.net/doc/Doxygen/html/"
             title="Source Guide">OpenFOAM C++ Documentation
          </a>
        </h1>
      </div>
    </div>  <!-- header-top -->
  </div>  <!-- header -->
  <div class="main">
    <div>
    <!-- begin of doxygen-generated content -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a6e4fee11f07c3b70486e88fe92cbbdc.html">applications</a></li><li class="navelem"><a class="el" href="dir_a740ba71acc8f57051af57c325cf1aa6.html">utilities</a></li><li class="navelem"><a class="el" href="dir_2cb9088fcfa5d85f3ea0b5a37d6be287.html">preProcessing</a></li><li class="navelem"><a class="el" href="dir_ca683ed4d325474578cdfb0340d1c3f5.html">viewFactorsGen</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">viewFactorsGen.C</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a04583.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*---------------------------------------------------------------------------*\</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">  =========                 |</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">   \\    /   O peration     |</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    \\  /    A nd           | Copyright (C) 2011-2016 OpenFOAM Foundation</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">     \\/     M anipulation  |</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">-------------------------------------------------------------------------------</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">License</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">    This file is part of OpenFOAM.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">    OpenFOAM is free software: you can redistribute it and/or modify it</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">    under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">    the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">    (at your option) any later version.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">    OpenFOAM is distributed in the hope that it will be useful, but WITHOUT</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">    FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">    for more details.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">    You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">    along with OpenFOAM.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">Application</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">    viewFactorsGen</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">Description</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">    View factors are calculated based on a face agglomeration array</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">    (finalAgglom generated by faceAgglomerate utility).</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">    Each view factor between the agglomerated faces i and j (Fij) is calculated</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">    using a double integral of the sub-areas composing the agglomaration.</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">    The patches involved in the view factor calculation are taken from the Qr</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">    volScalarField (radiative flux) when is greyDiffusiveRadiationViewFactor</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">    otherwise they are not included.</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">\*---------------------------------------------------------------------------*/</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a08162.html">argList.H</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07869.html">Time.H</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a05885.html">fvMesh.H</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a05943.html">singleCellFvMesh.H</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a05623.html">volFields.H</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a05618.html">surfaceFields.H</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a05195.html">fixedValueFvPatchFields.H</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a09127.html">distributedTriSurfaceMesh.H</a>&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07228.html">cyclicAMIPolyPatch.H</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a08627.html">mapDistribute.H</a>&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07317.html">meshTools.H</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a08769.html">uindirectPrimitivePatch.H</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a07952.html">DynamicField.H</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a08442.html">scalarMatrices.H</a>&quot;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a08949.html">scalarListIOList.H</a>&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">using namespace </span><a class="code" href="a10742.html">Foam</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<a class="code" href="a02689.html">triSurface</a> triangulate</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;(</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01916.html">polyBoundaryMesh</a>&amp; bMesh,</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00985.html">labelHashSet</a>&amp; includePatches,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01178.html">labelListIOList</a>&amp; finalAgglom,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="a01367.html">labelList</a>&amp; triSurfaceToAgglom,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00934.html">globalIndex</a>&amp; globalNumbering,</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01916.html">polyBoundaryMesh</a>&amp; coarsePatches</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01922.html">polyMesh</a>&amp; mesh = bMesh.<a class="code" href="a01916.html#aa51573bc757d5d5bb058db0464886447">mesh</a>();</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Storage for surfaceMesh. Size estimate.</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="a00605.html">DynamicList&lt;labelledTri&gt;</a> triangles</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    (</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        mesh.<a class="code" href="a01974.html#a9be088de373a98524a153de7da0e92e8">nFaces</a>() - mesh.<a class="code" href="a01974.html#aa1eec60bd258a70018b8ffda0dced7bb">nInternalFaces</a>()</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    );</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> newPatchI = 0;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> localTriFaceI = 0;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="a02966.html#ae21e2836509b0fa7f7cedf6493b11b09">forAllConstIter</a>(<a class="code" href="a00985.html">labelHashSet</a>, includePatches, iter)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> patchI = iter.key();</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01940.html">polyPatch</a>&amp; patch = bMesh[patchI];</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; points = patch.<a class="code" href="a01977.html#a1f42f31bcf706357682dcf097255b544">points</a>();</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nTriTotal = 0;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(patch, patchFaceI)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keyword">const</span> <a class="code" href="a00716.html">face</a>&amp; f = patch[patchFaceI];</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <a class="code" href="a01367.html">faceList</a> triFaces(f.<a class="code" href="a00716.html#adf12beb51bcfe12477e066681cf0ac80">nTriangles</a>(points));</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nTri = 0;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            f.<a class="code" href="a00716.html#acf1f421759f62e0e96e9bf3287fa67a8">triangles</a>(points, nTri, triFaces);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(triFaces, triFaceI)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="keyword">const</span> <a class="code" href="a00716.html">face</a>&amp; f = triFaces[triFaceI];</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                triangles.<a class="code" href="a01367.html#a399dd2bf0d9a32016717dc90126f016b">append</a>(<a class="code" href="a01254.html">labelledTri</a>(f[0], f[1], f[2], newPatchI));</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                nTriTotal++;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                triSurfaceToAgglom[localTriFaceI++] = globalNumbering.<a class="code" href="a00934.html#a7d52ac47ea25cc49744fc5658630a929">toGlobal</a></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                (</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    <a class="code" href="a02772.html#afc74d89573de32a3032c916f8cdd1733">Pstream::myProcNo</a>(),</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    finalAgglom[patchI][patchFaceI]</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                  + coarsePatches[patchI].start()</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                );</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        newPatchI++;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    triSurfaceToAgglom.<a class="code" href="a01367.html#a4eb7a78f8b52136a8668d0e785dace04">resize</a>(localTriFaceI);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    triangles.shrink();</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// Create globally numbered tri surface</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="a02689.html">triSurface</a> rawSurface(triangles, mesh.<a class="code" href="a01922.html#a084ae534298576408f063a6b3b820959">points</a>());</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// Create locally numbered tri surface</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="a02689.html">triSurface</a> surface</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    (</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        rawSurface.localFaces(),</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        rawSurface.localPoints()</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    );</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// Add patch names to surface</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    surface.<a class="code" href="a02689.html#a40a43f76fd50b5f1cd1c242669a14406">patches</a>().<a class="code" href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">setSize</a>(newPatchI);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    newPatchI = 0;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="a02966.html#ae21e2836509b0fa7f7cedf6493b11b09">forAllConstIter</a>(<a class="code" href="a00985.html">labelHashSet</a>, includePatches, iter)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> patchI = iter.key();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01940.html">polyPatch</a>&amp; patch = bMesh[patchI];</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        surface.patches()[newPatchI].index() = patchI;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        surface.patches()[newPatchI].<a class="code" href="a01182.html#a75b72488d2e82151b025744974919d5d">name</a>() = patch.<a class="code" href="a01805.html#a75b72488d2e82151b025744974919d5d">name</a>();</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        surface.patches()[newPatchI].geometricType() = patch.type();</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        newPatchI++;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">return</span> surface;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordtype">void</span> writeRays</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;(</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00781.html">fileName</a>&amp; fName,</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; compactCf,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; myFc,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelListList</a>&amp; visibleFaceFaces</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="a01709.html">OFstream</a> str(fName);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> vertI = 0;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <span class="stringliteral">&quot;Dumping rays to &quot;</span> &lt;&lt; str.<a class="code" href="a01741.html#ab27acd1d200f0d245337451aa2f31517">name</a>() &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(myFc, faceI)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a> visFaces = visibleFaceFaces[faceI];</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(visFaces, faceRemote)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> compactI = visFaces[faceRemote];</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keyword">const</span> <a class="code" href="a02797.html">point</a>&amp; remoteFc = compactCf[compactI];</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(str, myFc[faceI]);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            vertI++;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <a class="code" href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">meshTools::writeOBJ</a>(str, remoteFc);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            vertI++;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            str &lt;&lt; <span class="stringliteral">&quot;l &quot;</span> &lt;&lt; vertI-1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; vertI &lt;&lt; <a class="code" href="a10742.html#ae53117a9770efe95d2d01bb5cc2c99ef">nl</a>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">string</span> cmd(<span class="stringliteral">&quot;objToVTK &quot;</span> + fName + <span class="stringliteral">&quot; &quot;</span> + fName.<a class="code" href="a00781.html#a8313eb64672be97529ce588ee8004061">lessExt</a>() + <span class="stringliteral">&quot;.vtk&quot;</span>);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a>&lt;&lt; <span class="stringliteral">&quot;cmd:&quot;</span> &lt;&lt; cmd &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="a10742.html#a08486711870135b87b73161e8f2fa4ed">system</a>(cmd);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;scalar calculateViewFactorFij</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;(</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; i,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; j,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; dAi,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; dAj</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="a02797.html">vector</a> r = i - j;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    scalar rMag = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(r);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> (rMag &gt; SMALL)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        scalar dAiMag = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(dAi);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        scalar dAjMag = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(dAj);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="a02797.html">vector</a> ni = dAi/dAiMag;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="a02797.html">vector</a> nj = dAj/dAjMag;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        scalar cosThetaJ = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(nj &amp; r)/rMag;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        scalar cosThetaI = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(ni &amp; r)/rMag;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">return</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        (</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            (cosThetaI*cosThetaJ*dAjMag*dAiMag)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            /(<a class="code" href="a10742.html#a277dc11c581d53826ab5090b08f3b17b">sqr</a>(rMag)*<a class="code" href="a10754.html#a731b8788a4c01586c35266c7ca4fed04">constant::mathematical::pi</a>)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        );</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordtype">void</span> insertMatrixElements</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;(</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">const</span> <a class="code" href="a00934.html">globalIndex</a>&amp; globalNumbering,</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> fromProcI,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">labelListList</a>&amp; globalFaceFaces,</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01367.html">scalarListList</a>&amp; viewFactors,</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="a02419.html">scalarSquareMatrix</a>&amp; matrix</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;{</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(viewFactors, faceI)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01367.html">scalarList</a>&amp; vf = viewFactors[faceI];</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; globalFaces = globalFaceFaces[faceI];</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> globalI = globalNumbering.<a class="code" href="a00934.html#a7d52ac47ea25cc49744fc5658630a929">toGlobal</a>(fromProcI, faceI);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(globalFaces, i)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            matrix[globalI][globalFaces[i]] = vf[i];</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keywordtype">int</span> <a class="code" href="a09425.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;{</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">    #include &quot;<a class="code" href="a08212.html">addRegionOption.H</a>&quot;</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">    #include &quot;<a class="code" href="a08227.html">setRootCase.H</a>&quot;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">    #include &quot;<a class="code" href="a08223.html">createTime.H</a>&quot;</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">    #include &quot;<a class="code" href="a08220.html">createNamedMesh.H</a>&quot;</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// Read view factor dictionary</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="a01175.html">IOdictionary</a> viewFactorDict</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    (</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;       <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;       (</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="stringliteral">&quot;viewFactorsDict&quot;</span>,</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            runTime.constant(),</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <a class="code" href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a6be8dd810194d4022a4faec0a869d418">IOobject::MUST_READ_IF_MODIFIED</a>,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;       )</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    );</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> writeViewFactors =</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        viewFactorDict.lookupOrDefault&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;writeViewFactorMatrix&quot;</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> dumpRays =</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        viewFactorDict.lookupOrDefault&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;dumpRays&quot;</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> debug = viewFactorDict.lookupOrDefault&lt;<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a>&gt;(<span class="stringliteral">&quot;debug&quot;</span>, 0);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="a00924.html">volScalarField</a> <a class="code" href="a04437.html#a78bcf340cde4f20cf12473945680d11a">Qr</a></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    (</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        (</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="stringliteral">&quot;Qr&quot;</span>,</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            runTime.timeName(),</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <a class="code" href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a9e7b8f2e0979fecd1bbc84564f3d3891">IOobject::MUST_READ</a>,</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        ),</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        mesh</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    );</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// Read agglomeration map</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="a01178.html">labelListIOList</a> finalAgglom</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    (</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        (</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="stringliteral">&quot;finalAgglom&quot;</span>,</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            mesh.<a class="code" href="a01922.html#a8a91e85dc9825a7ae05720d4e7b48f2a">facesInstance</a>(),</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <a class="code" href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a9e7b8f2e0979fecd1bbc84564f3d3891">IOobject::MUST_READ</a>,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a>,</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            false</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        )</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    );</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// Create the coarse mesh  using agglomeration</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (debug)</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a> &lt;&lt; <span class="stringliteral">&quot;\nCreating single cell mesh...&quot;</span> &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="a02323.html">singleCellFvMesh</a> coarseMesh</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    (</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        (</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="stringliteral">&quot;coarse:&quot;</span> + mesh.<a class="code" href="a01182.html#a75b72488d2e82151b025744974919d5d">name</a>(),</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            runTime.timeName(),</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            runTime,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a2236347a9c1072b71703cbc5eccbad05">IOobject::NO_READ</a>,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        ),</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        mesh,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        finalAgglom</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    );</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (debug)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a> &lt;&lt; <span class="stringliteral">&quot;\nCreated single cell mesh...&quot;</span> &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// Calculate total number of fine and coarse faces</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nCoarseFaces = 0;      <span class="comment">//total number of coarse faces</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nFineFaces = 0;        <span class="comment">//total number of fine faces</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01916.html">polyBoundaryMesh</a>&amp; patches = mesh.<a class="code" href="a01922.html#a6b7f5ba89250dbd7a1c6c7860ab60fe3">boundaryMesh</a>();</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">const</span> <a class="code" href="a01916.html">polyBoundaryMesh</a>&amp; coarsePatches = coarseMesh.boundaryMesh();</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="a01367.html">labelList</a> viewFactorsPatches(patches.<a class="code" href="a02038.html#a723361dc2020160f5492e8fe2d09fa44">size</a>());</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">const</span> volScalarField::GeometricBoundaryField&amp; Qrb = <a class="code" href="a04437.html#a78bcf340cde4f20cf12473945680d11a">Qr</a>.<a class="code" href="a00924.html#a3c6c1a789b48ea0c5e8bff64f9c14f2d">boundaryField</a>();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> count = 0;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(Qrb, patchI)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01940.html">polyPatch</a>&amp; pp = patches[patchI];</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00889.html">fvPatchScalarField</a>&amp; QrpI = Qrb[patchI];</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">if</span> ((isA&lt;fixedValueFvPatchScalarField&gt;(QrpI)) &amp;&amp; (pp.size() &gt; 0))</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            viewFactorsPatches[count] = QrpI.<a class="code" href="a00889.html#ad735de1fbd0f85c12ad0c37deb62d22c">patch</a>().<a class="code" href="a00888.html#a7d1e8acadb27bd2b4e61457d47b71b6f">index</a>();</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            nCoarseFaces += coarsePatches[patchI].<a class="code" href="a02038.html#a723361dc2020160f5492e8fe2d09fa44">size</a>();</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            nFineFaces += patches[patchI].<a class="code" href="a02038.html#a723361dc2020160f5492e8fe2d09fa44">size</a>();</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            count ++;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    viewFactorsPatches.resize(count);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// total number of coarse faces</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> totalNCoarseFaces = nCoarseFaces;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="a10742.html#a7ffd6af4acc2eb9ba72ee296b5ecda23">reduce</a>(totalNCoarseFaces, <a class="code" href="a02475.html">sumOp&lt;label&gt;</a>());</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02772.html#a36af549940a0aae3733774649594489f">Pstream::master</a>())</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="a10742.html#a501e80d1e14c94973e82f1555e7eb711">Info</a> &lt;&lt; <span class="stringliteral">&quot;\nTotal number of coarse faces: &quot;</span>&lt;&lt; totalNCoarseFaces &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02772.html#a36af549940a0aae3733774649594489f">Pstream::master</a>() &amp;&amp; debug)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <a class="code" href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Pout</a> &lt;&lt; <span class="stringliteral">&quot;\nView factor patches included in the calculation : &quot;</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;             &lt;&lt; viewFactorsPatches &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// Collect local Cf and Sf on coarse mesh</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="a00605.html">DynamicList&lt;point&gt;</a> localCoarseCf(nCoarseFaces);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="a00605.html">DynamicList&lt;point&gt;</a> localCoarseSf(nCoarseFaces);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="a00605.html">DynamicList&lt;label&gt;</a> localAgg(nCoarseFaces);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(viewFactorsPatches, i)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> patchID = viewFactorsPatches[i];</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01940.html">polyPatch</a>&amp; pp = patches[patchID];</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; agglom = finalAgglom[patchID];</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nAgglom = <a class="code" href="a10742.html#ac993e906cf2774ae77e666bc24e81733">max</a>(agglom)+1;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <a class="code" href="a01367.html">labelListList</a> coarseToFine(<a class="code" href="a10742.html#a5da5e7d950073675f3b3d26323a640db">invertOneToMany</a>(nAgglom, agglom));</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; coarsePatchFace = coarseMesh.patchFaceMap()[patchID];</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; coarseCf = coarseMesh.Cf().boundaryField()[patchID];</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00756.html">pointField</a>&amp; coarseSf = coarseMesh.Sf().boundaryField()[patchID];</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="a00985.html">labelHashSet</a> <a class="code" href="a04581.html#a1f4c40f87f6a6e206dcec45518ac4afd">includePatches</a>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        includePatches.<a class="code" href="a00985.html#a49f0753d9652681fc3a81f59951a0ad7">insert</a>(patchID);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(coarseCf, faceI)</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <a class="code" href="a02797.html">point</a> cf = coarseCf[faceI];</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> coarseFaceI = coarsePatchFace[faceI];</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; fineFaces = coarseToFine[coarseFaceI];</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> agglomI =</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                agglom[fineFaces[0]] + coarsePatches[patchID].start();</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="comment">// Construct single face</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <a class="code" href="a01977.html">uindirectPrimitivePatch</a> upp</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            (</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                <a class="code" href="a02739.html">UIndirectList&lt;face&gt;</a>(pp, fineFaces),</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                pp.<a class="code" href="a01977.html#a1f42f31bcf706357682dcf097255b544">points</a>()</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            );</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <a class="code" href="a01367.html">List&lt;point&gt;</a> availablePoints</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            (</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                upp.faceCentres().size()</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;              + upp.localPoints().size()</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            );</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <a class="code" href="a02472.html">SubList&lt;point&gt;</a></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            (</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                availablePoints,</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                upp.faceCentres().size()</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            ).assign(upp.faceCentres());</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <a class="code" href="a02472.html">SubList&lt;point&gt;</a></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            (</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                availablePoints,</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                upp.localPoints().size(),</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                upp.faceCentres().size()</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            ).assign(upp.localPoints());</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <a class="code" href="a02797.html">point</a> cfo = cf;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            scalar dist = GREAT;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(availablePoints, iPoint)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <a class="code" href="a02797.html">point</a> cfFine = availablePoints[iPoint];</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(cfFine-cfo) &lt; dist)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    dist = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(cfFine-cfo);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                    cf = cfFine;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <a class="code" href="a02797.html">point</a> sf = coarseSf[faceI];</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            localCoarseCf.<a class="code" href="a01367.html#a399dd2bf0d9a32016717dc90126f016b">append</a>(cf);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            localCoarseSf.append(sf);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            localAgg.append(agglomI);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// Distribute local coarse Cf and Sf for shooting rays</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="a01367.html">List&lt;pointField&gt;</a> remoteCoarseCf(<a class="code" href="a02772.html#aada0e04d8127eda8ee95be0772754a4f">Pstream::nProcs</a>());</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="a01367.html">List&lt;pointField&gt;</a> remoteCoarseSf(<a class="code" href="a02772.html#aada0e04d8127eda8ee95be0772754a4f">Pstream::nProcs</a>());</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="a01367.html">List&lt;labelField&gt;</a> remoteCoarseAgg(<a class="code" href="a02772.html#aada0e04d8127eda8ee95be0772754a4f">Pstream::nProcs</a>());</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    remoteCoarseCf[<a class="code" href="a02772.html#afc74d89573de32a3032c916f8cdd1733">Pstream::myProcNo</a>()] = localCoarseCf;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    remoteCoarseSf[<a class="code" href="a02772.html#afc74d89573de32a3032c916f8cdd1733">Pstream::myProcNo</a>()] = localCoarseSf;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    remoteCoarseAgg[<a class="code" href="a02772.html#afc74d89573de32a3032c916f8cdd1733">Pstream::myProcNo</a>()] = localAgg;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="a02022.html#afbdf64fb42cd760690d51a9a321792d9">Pstream::gatherList</a>(remoteCoarseCf);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="a02022.html#a23c38ee54f04c9d53a327db9edbdb7f0">Pstream::scatterList</a>(remoteCoarseCf);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="a02022.html#afbdf64fb42cd760690d51a9a321792d9">Pstream::gatherList</a>(remoteCoarseSf);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="a02022.html#a23c38ee54f04c9d53a327db9edbdb7f0">Pstream::scatterList</a>(remoteCoarseSf);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="a02022.html#afbdf64fb42cd760690d51a9a321792d9">Pstream::gatherList</a>(remoteCoarseAgg);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="a02022.html#a23c38ee54f04c9d53a327db9edbdb7f0">Pstream::scatterList</a>(remoteCoarseAgg);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="a00934.html">globalIndex</a> globalNumbering(nCoarseFaces);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// Set up searching engine for obstacles</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">    #include &quot;<a class="code" href="a04581.html">searchingEngine.H</a>&quot;</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// Determine rays between coarse face centres</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="a00605.html">DynamicList&lt;label&gt;</a> rayStartFace(nCoarseFaces + 0.01*nCoarseFaces);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="a00605.html">DynamicList&lt;label&gt;</a> rayEndFace(rayStartFace.size());</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// Return rayStartFace in local index andrayEndFace in global index</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="preprocessor">    #include &quot;<a class="code" href="a04582.html">shootRays.H</a>&quot;</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// Calculate number of visible faces from local index</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="a01367.html">labelList</a> nVisibleFaceFaces(nCoarseFaces, 0);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(rayStartFace, i)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        nVisibleFaceFaces[rayStartFace[i]]++;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="a01367.html">labelListList</a> visibleFaceFaces(nCoarseFaces);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nViewFactors = 0;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(nVisibleFaceFaces, faceI)</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        visibleFaceFaces[faceI].<a class="code" href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">setSize</a>(nVisibleFaceFaces[faceI]);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        nViewFactors += nVisibleFaceFaces[faceI];</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// - Construct compact numbering</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// - return map from remote to compact indices</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">//   (per processor (!= myProcNo) a map from remote index to compact index)</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// - construct distribute map</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">// - renumber rayEndFace into compact addressing</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="a01367.html">List&lt;Map&lt;label&gt;</a>&gt; compactMap(<a class="code" href="a02772.html#aada0e04d8127eda8ee95be0772754a4f">Pstream::nProcs</a>());</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="a01406.html">mapDistribute</a> map(globalNumbering, rayEndFace, compactMap);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <a class="code" href="a01178.html">labelListIOList</a> IOsubMap</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    (</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        (</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="stringliteral">&quot;subMap&quot;</span>,</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            mesh.<a class="code" href="a01922.html#a8a91e85dc9825a7ae05720d4e7b48f2a">facesInstance</a>(),</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <a class="code" href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>,</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a2236347a9c1072b71703cbc5eccbad05">IOobject::NO_READ</a>,</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a>,</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            false</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        ),</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        map.subMap()</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    );</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    IOsubMap.<a class="code" href="a02152.html#a6e5faa425b059eeb55cd904755791076">write</a>();</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="a01178.html">labelListIOList</a> IOconstructMap</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    (</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        (</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="stringliteral">&quot;constructMap&quot;</span>,</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            mesh.<a class="code" href="a01922.html#a8a91e85dc9825a7ae05720d4e7b48f2a">facesInstance</a>(),</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <a class="code" href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>,</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a2236347a9c1072b71703cbc5eccbad05">IOobject::NO_READ</a>,</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a>,</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            false</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        ),</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        map.constructMap()</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    );</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    IOconstructMap.<a class="code" href="a02152.html#a6e5faa425b059eeb55cd904755791076">write</a>();</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="a01178.html">IOList&lt;label&gt;</a> consMapDim</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    (</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        (</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="stringliteral">&quot;constructMapDim&quot;</span>,</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            mesh.<a class="code" href="a01922.html#a8a91e85dc9825a7ae05720d4e7b48f2a">facesInstance</a>(),</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <a class="code" href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>,</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a2236347a9c1072b71703cbc5eccbad05">IOobject::NO_READ</a>,</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a>,</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            false</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        ),</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="a01367.html">List&lt;label&gt;</a>(1, map.constructSize())</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    );</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    consMapDim.write();</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// visibleFaceFaces has:</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">//    (local face, local viewed face) = compact viewed face</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    nVisibleFaceFaces = 0;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(rayStartFace, i)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> faceI = rayStartFace[i];</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> compactI = rayEndFace[i];</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        visibleFaceFaces[faceI][nVisibleFaceFaces[faceI]++] = compactI;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// Construct data in compact addressing</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">// I need coarse Sf (Ai), fine Sf (dAi) and fine Cf(r) to calculate Fij</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <a class="code" href="a00756.html">pointField</a> compactCoarseCf(map.constructSize(), <a class="code" href="a02024.html">pTraits&lt;vector&gt;::zero</a>);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="a00756.html">pointField</a> compactCoarseSf(map.constructSize(), <a class="code" href="a02024.html">pTraits&lt;vector&gt;::zero</a>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="a01367.html">List&lt;List&lt;point&gt;</a>&gt; compactFineSf(map.constructSize());</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="a01367.html">List&lt;List&lt;point&gt;</a>&gt; compactFineCf(map.constructSize());</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="a00605.html">DynamicList&lt;label&gt;</a> compactPatchId(map.constructSize());</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// Insert my coarse local values</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="a02472.html">SubList&lt;point&gt;</a>(compactCoarseSf, nCoarseFaces).assign(localCoarseSf);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <a class="code" href="a02472.html">SubList&lt;point&gt;</a>(compactCoarseCf, nCoarseFaces).assign(localCoarseCf);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">// Insert my fine local values</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> compactI = 0;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(viewFactorsPatches, i)</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> patchID = viewFactorsPatches[i];</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; agglom = finalAgglom[patchID];</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nAgglom = <a class="code" href="a10742.html#ac993e906cf2774ae77e666bc24e81733">max</a>(agglom)+1;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="a01367.html">labelListList</a> coarseToFine(<a class="code" href="a10742.html#a5da5e7d950073675f3b3d26323a640db">invertOneToMany</a>(nAgglom, agglom));</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; coarsePatchFace = coarseMesh.patchFaceMap()[patchID];</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(coarseToFine, coarseI)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            compactPatchId.append(patchID);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <a class="code" href="a01367.html">List&lt;point&gt;</a>&amp; fineCf = compactFineCf[compactI];</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <a class="code" href="a01367.html">List&lt;point&gt;</a>&amp; fineSf = compactFineSf[compactI++];</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> coarseFaceI = coarsePatchFace[coarseI];</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; fineFaces = coarseToFine[coarseFaceI];</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            fineCf.<a class="code" href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">setSize</a>(fineFaces.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            fineSf.<a class="code" href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">setSize</a>(fineFaces.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            fineCf = <a class="code" href="a02739.html">UIndirectList&lt;point&gt;</a></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            (</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                mesh.Cf().boundaryField()[patchID],</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                coarseToFine[coarseFaceI]</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            );</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            fineSf = <a class="code" href="a02739.html">UIndirectList&lt;point&gt;</a></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            (</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                mesh.Sf().boundaryField()[patchID],</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                coarseToFine[coarseFaceI]</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            );</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">// Do all swapping</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    map.distribute(compactCoarseSf);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    map.distribute(compactCoarseCf);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    map.distribute(compactFineCf);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    map.distribute(compactFineSf);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    map.distribute(compactPatchId);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">// Plot all rays between visible faces.</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">if</span> (dumpRays)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        writeRays</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        (</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            runTime.path()/<span class="stringliteral">&quot;allVisibleFaces.obj&quot;</span>,</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            compactCoarseCf,</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            remoteCoarseCf[<a class="code" href="a02772.html#afc74d89573de32a3032c916f8cdd1733">Pstream::myProcNo</a>()],</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            visibleFaceFaces</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        );</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// Fill local view factor matrix</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="a01178.html">scalarListIOList</a> <a class="code" href="a10755.html#a2774afe1f96ab9c80af9ea7946f17bde">F</a></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    (</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        (</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="stringliteral">&quot;F&quot;</span>,</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            mesh.<a class="code" href="a01922.html#a8a91e85dc9825a7ae05720d4e7b48f2a">facesInstance</a>(),</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <a class="code" href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>,</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a2236347a9c1072b71703cbc5eccbad05">IOobject::NO_READ</a>,</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a>,</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            false</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        ),</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        nCoarseFaces</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    );</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> totalPatches = coarsePatches.<a class="code" href="a02038.html#a723361dc2020160f5492e8fe2d09fa44">size</a>();</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="a10742.html#a7ffd6af4acc2eb9ba72ee296b5ecda23">reduce</a>(totalPatches, <a class="code" href="a01451.html">maxOp&lt;label&gt;</a>());</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="comment">// Matrix sum in j(Fij) for each i (if enclosure sum = 1)</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <a class="code" href="a02419.html">scalarSquareMatrix</a> sumViewFactorPatch</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    (</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        totalPatches,</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        totalPatches,</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        0.0</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    );</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="a01367.html">scalarList</a> patchArea(totalPatches, 0.0);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02772.html#a36af549940a0aae3733774649594489f">Pstream::master</a>())</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <a class="code" href="a10742.html#a501e80d1e14c94973e82f1555e7eb711">Info</a>&lt;&lt; <span class="stringliteral">&quot;\nCalculating view factors...&quot;</span> &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">if</span> (mesh.<a class="code" href="a01922.html#a061a278c425f5eaa95a0a5ee973a332f">nSolutionD</a>() == 3)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(localCoarseSf, coarseFaceI)</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        {</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="keyword">const</span> <a class="code" href="a01367.html">List&lt;point&gt;</a>&amp; localFineSf = compactFineSf[coarseFaceI];</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a> Ai = <a class="code" href="a10742.html#a3d8733143aad0e03b300186ab4bef137">sum</a>(localFineSf);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="keyword">const</span> <a class="code" href="a01367.html">List&lt;point&gt;</a>&amp; localFineCf = compactFineCf[coarseFaceI];</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> fromPatchId = compactPatchId[coarseFaceI];</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            patchArea[fromPatchId] += <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Ai);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; visCoarseFaces = visibleFaceFaces[coarseFaceI];</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(visCoarseFaces, visCoarseFaceI)</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            {</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                <a class="code" href="a10755.html#a2774afe1f96ab9c80af9ea7946f17bde">F</a>[coarseFaceI].setSize(visCoarseFaces.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> compactJ = visCoarseFaces[visCoarseFaceI];</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <span class="keyword">const</span> <a class="code" href="a01367.html">List&lt;point&gt;</a>&amp; remoteFineSj = compactFineSf[compactJ];</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <span class="keyword">const</span> <a class="code" href="a01367.html">List&lt;point&gt;</a>&amp; remoteFineCj = compactFineCf[compactJ];</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> toPatchId = compactPatchId[compactJ];</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                scalar Fij = 0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(localFineSf, i)</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                    <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; dAi = localFineSf[i];</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; dCi = localFineCf[i];</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(remoteFineSj, j)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                        <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; dAj = remoteFineSj[j];</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                        <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; dCj = remoteFineCj[j];</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                        scalar dIntFij = calculateViewFactorFij</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                        (</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                            dCi,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                            dCj,</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                            dAi,</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                            dAj</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                        );</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                        Fij += dIntFij;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                    }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <a class="code" href="a10755.html#a2774afe1f96ab9c80af9ea7946f17bde">F</a>[coarseFaceI][visCoarseFaceI] = Fij/<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Ai);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                sumViewFactorPatch[fromPatchId][toPatchId] += Fij;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh.<a class="code" href="a01922.html#a061a278c425f5eaa95a0a5ee973a332f">nSolutionD</a>() == 2)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keyword">const</span> <a class="code" href="a00156.html">boundBox</a>&amp; box = mesh.<a class="code" href="a01922.html#a7774f6a2399cc071ff06ba6bb6d38b26">bounds</a>();</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keyword">const</span> <a class="code" href="a02797.html">Vector&lt;label&gt;</a>&amp; dirs = mesh.<a class="code" href="a01922.html#aa81cc7eb673aa92f482daaa8685202ee">geometricD</a>();</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <a class="code" href="a02797.html">vector</a> emptyDir = <a class="code" href="a02797.html#ac3b79445511a1e3a6443b59ac93c394a">vector::zero</a>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(dirs, i)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="keywordflow">if</span> (dirs[i] == -1)</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                emptyDir[i] = 1.0;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        scalar wideBy2 = (box.<a class="code" href="a00156.html#a2d9f25638302501b870cd5be87974010">span</a>() &amp; emptyDir)*2.0;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(localCoarseSf, coarseFaceI)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; Ai = localCoarseSf[coarseFaceI];</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; Ci = localCoarseCf[coarseFaceI];</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <a class="code" href="a02797.html">vector</a> Ain = Ai/<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Ai);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <a class="code" href="a02797.html">vector</a> R1i = Ci + (<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Ai)/wideBy2)*(Ain ^ emptyDir);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <a class="code" href="a02797.html">vector</a> R2i = Ci - (<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Ai)/wideBy2)*(Ain ^ emptyDir) ;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> fromPatchId = compactPatchId[coarseFaceI];</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            patchArea[fromPatchId] += <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Ai);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; visCoarseFaces = visibleFaceFaces[coarseFaceI];</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(visCoarseFaces, visCoarseFaceI)</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <a class="code" href="a10755.html#a2774afe1f96ab9c80af9ea7946f17bde">F</a>[coarseFaceI].setSize(visCoarseFaces.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> compactJ = visCoarseFaces[visCoarseFaceI];</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; Aj = compactCoarseSf[compactJ];</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <span class="keyword">const</span> <a class="code" href="a02797.html">vector</a>&amp; Cj = compactCoarseCf[compactJ];</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> toPatchId = compactPatchId[compactJ];</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <a class="code" href="a02797.html">vector</a> Ajn = Aj/<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Aj);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                <a class="code" href="a02797.html">vector</a> R1j = Cj + (<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Aj)/wideBy2)*(Ajn ^ emptyDir);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <a class="code" href="a02797.html">vector</a> R2j = Cj - (<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Aj)/wideBy2)*(Ajn ^ emptyDir);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                scalar d1 = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(R1i - R2j);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                scalar d2 = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(R2i - R1j);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                scalar s1 = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(R1i - R1j);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                scalar s2 = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(R2i - R2j);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                scalar Fij = <a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>((d1 + d2) - (s1 + s2))/(4.0*<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Ai)/wideBy2);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                <a class="code" href="a10755.html#a2774afe1f96ab9c80af9ea7946f17bde">F</a>[coarseFaceI][visCoarseFaceI] = Fij;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                sumViewFactorPatch[fromPatchId][toPatchId] += Fij*<a class="code" href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">mag</a>(Ai);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02772.html#a36af549940a0aae3733774649594489f">Pstream::master</a>())</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <a class="code" href="a10742.html#a501e80d1e14c94973e82f1555e7eb711">Info</a> &lt;&lt; <span class="stringliteral">&quot;Writing view factor matrix...&quot;</span> &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    }</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">// Write view factors matrix in listlist form</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <a class="code" href="a10755.html#a2774afe1f96ab9c80af9ea7946f17bde">F</a>.write();</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <a class="code" href="a10742.html#a7ffd6af4acc2eb9ba72ee296b5ecda23">reduce</a>(sumViewFactorPatch, <a class="code" href="a02475.html">sumOp&lt;scalarSquareMatrix&gt;</a>());</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <a class="code" href="a10742.html#a7ffd6af4acc2eb9ba72ee296b5ecda23">reduce</a>(patchArea, <a class="code" href="a02475.html">sumOp&lt;scalarList&gt;</a>());</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02772.html#a36af549940a0aae3733774649594489f">Pstream::master</a>() &amp;&amp; debug)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(viewFactorsPatches, i)</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> patchI =  viewFactorsPatches[i];</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(viewFactorsPatches, i)</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> patchJ =  viewFactorsPatches[i];</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <a class="code" href="a10742.html#a501e80d1e14c94973e82f1555e7eb711">Info</a> &lt;&lt; <span class="stringliteral">&quot;F&quot;</span> &lt;&lt; patchI &lt;&lt; patchJ &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                     &lt;&lt; sumViewFactorPatch[patchI][patchJ]/patchArea[patchI]</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                     &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">if</span> (writeViewFactors)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <a class="code" href="a00924.html">volScalarField</a> viewFactorField</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        (</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            (</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="stringliteral">&quot;viewFactorField&quot;</span>,</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                mesh.<a class="code" href="a01695.html#a48fcf6de2789aff6b430b5fc1a05693f">time</a>().<a class="code" href="a02616.html#a5ae6a110de1b22323e19a46943c7f0c1">timeName</a>(),</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <a class="code" href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>,</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a2236347a9c1072b71703cbc5eccbad05">IOobject::NO_READ</a>,</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            ),</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            mesh,</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <a class="code" href="a10742.html#a072b5cdfc288c7565684d29740185304">dimensionedScalar</a>(<span class="stringliteral">&quot;viewFactorField&quot;</span>, <a class="code" href="a10742.html#a22e1fa85a26a2936be87e1582718e0cc">dimless</a>, 0)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        );</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> compactI = 0;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(viewFactorsPatches, i)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> patchID = viewFactorsPatches[i];</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; agglom = finalAgglom[patchID];</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> nAgglom = <a class="code" href="a10742.html#ac993e906cf2774ae77e666bc24e81733">max</a>(agglom)+1;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <a class="code" href="a01367.html">labelListList</a> coarseToFine(<a class="code" href="a10742.html#a5da5e7d950073675f3b3d26323a640db">invertOneToMany</a>(nAgglom, agglom));</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; coarsePatchFace =</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                coarseMesh.patchFaceMap()[patchID];</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(coarseToFine, coarseI)</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            {</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <span class="keyword">const</span> scalar Fij = <a class="code" href="a10742.html#a3d8733143aad0e03b300186ab4bef137">sum</a>(<a class="code" href="a10755.html#a2774afe1f96ab9c80af9ea7946f17bde">F</a>[compactI]);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> coarseFaceID = coarsePatchFace[coarseI];</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                <span class="keyword">const</span> <a class="code" href="a01367.html">labelList</a>&amp; fineFaces = coarseToFine[coarseFaceID];</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(fineFaces, fineId)</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                {</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                    <span class="keyword">const</span> <a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> faceID = fineFaces[fineId];</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    viewFactorField.boundaryField()[patchID][faceID] = Fij;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                compactI++;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        viewFactorField.write();</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">// Invert compactMap (from processor+localface to compact) to go</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">// from compact to processor+localface (expressed as a globalIndex)</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// globalIndex globalCoarFaceNum(coarseMesh.nFaces());</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="a01367.html">labelList</a> compactToGlobal(map.constructSize());</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// Local indices first (note: are not in compactMap)</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">label</a> i = 0; i &lt; globalNumbering.<a class="code" href="a00934.html#aa657795af2e35b1cd3ece418df75f4c0">localSize</a>(); i++)</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    {</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        compactToGlobal[i] = globalNumbering.<a class="code" href="a00934.html#a7d52ac47ea25cc49744fc5658630a929">toGlobal</a>(i);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    }</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(compactMap, procI)</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    {</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keyword">const</span> <a class="code" href="a01404.html">Map&lt;label&gt;</a>&amp; localToCompactMap = compactMap[procI];</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <a class="code" href="a02966.html#ae21e2836509b0fa7f7cedf6493b11b09">forAllConstIter</a>(<a class="code" href="a01404.html">Map&lt;label&gt;</a>, localToCompactMap, iter)</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            compactToGlobal[iter()] = globalNumbering.<a class="code" href="a00934.html#a7d52ac47ea25cc49744fc5658630a929">toGlobal</a></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            (</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                procI,</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                iter.key()</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            );</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a02772.html#a36af549940a0aae3733774649594489f">Pstream::master</a>())</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <a class="code" href="a02419.html">scalarSquareMatrix</a> Fmatrix(totalNCoarseFaces, totalNCoarseFaces, 0.0);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <a class="code" href="a01367.html">labelListList</a> globalFaceFaces(visibleFaceFaces.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="comment">// Create globalFaceFaces needed to insert view factors</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="comment">// in F to the global matrix Fmatrix</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(globalFaceFaces, faceI)</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            globalFaceFaces[faceI] = <a class="code" href="a10742.html#a495791c4d9e97a9fb63adc1124e336dd">renumber</a></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            (</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                compactToGlobal,</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                visibleFaceFaces[faceI]</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            );</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        }</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <a class="code" href="a01178.html">labelListIOList</a> IOglobalFaceFaces</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        (</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            (</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                <span class="stringliteral">&quot;globalFaceFaces&quot;</span>,</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                mesh.<a class="code" href="a01922.html#a8a91e85dc9825a7ae05720d4e7b48f2a">facesInstance</a>(),</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                <a class="code" href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>,</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a2236347a9c1072b71703cbc5eccbad05">IOobject::NO_READ</a>,</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a>,</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                false</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            ),</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            globalFaceFaces</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        );</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        IOglobalFaceFaces.write();</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    }</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <a class="code" href="a01367.html">labelListList</a> globalFaceFaces(visibleFaceFaces.<a class="code" href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">size</a>());</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <a class="code" href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a>(globalFaceFaces, faceI)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            globalFaceFaces[faceI] = <a class="code" href="a10742.html#a495791c4d9e97a9fb63adc1124e336dd">renumber</a></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            (</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                compactToGlobal,</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                visibleFaceFaces[faceI]</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            );</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        }</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <a class="code" href="a01178.html">labelListIOList</a> IOglobalFaceFaces</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        (</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <a class="code" href="a01182.html">IOobject</a></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            (</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                <span class="stringliteral">&quot;globalFaceFaces&quot;</span>,</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                mesh.<a class="code" href="a01922.html#a8a91e85dc9825a7ae05720d4e7b48f2a">facesInstance</a>(),</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                <a class="code" href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a>,</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <a class="code" href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a2236347a9c1072b71703cbc5eccbad05">IOobject::NO_READ</a>,</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                <a class="code" href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">IOobject::NO_WRITE</a>,</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                false</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            ),</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            globalFaceFaces</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        );</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        IOglobalFaceFaces.write();</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="a10742.html#a501e80d1e14c94973e82f1555e7eb711">Info</a>&lt;&lt; <span class="stringliteral">&quot;End\n&quot;</span> &lt;&lt; <a class="code" href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">endl</a>;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;}</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">// ************************************************************************* //</span></div><div class="ttc" id="a09127_html"><div class="ttname"><a href="a09127.html">distributedTriSurfaceMesh.H</a></div></div>
<div class="ttc" id="a01451_html"><div class="ttname"><a href="a01451.html">Foam::maxOp</a></div><div class="ttdef"><b>Definition:</b> <a href="a08916_source.html#l00172">ops.H:172</a></div></div>
<div class="ttc" id="a08162_html"><div class="ttname"><a href="a08162.html">argList.H</a></div></div>
<div class="ttc" id="a08223_html"><div class="ttname"><a href="a08223.html">createTime.H</a></div></div>
<div class="ttc" id="a01367_html_a399dd2bf0d9a32016717dc90126f016b"><div class="ttname"><a href="a01367.html#a399dd2bf0d9a32016717dc90126f016b">Foam::List::append</a></div><div class="ttdeci">void append(const T &amp;)</div><div class="ttdoc">Append an element at the end of the list. </div><div class="ttdef"><b>Definition:</b> <a href="a07653_source.html#l00097">ListI.H:97</a></div></div>
<div class="ttc" id="a00924_html"><div class="ttname"><a href="a00924.html">Foam::GeometricField&lt; scalar, fvPatchField, volMesh &gt;</a></div></div>
<div class="ttc" id="a10742_html_a501e80d1e14c94973e82f1555e7eb711"><div class="ttname"><a href="a10742.html#a501e80d1e14c94973e82f1555e7eb711">Foam::Info</a></div><div class="ttdeci">messageStream Info</div></div>
<div class="ttc" id="a01916_html"><div class="ttname"><a href="a01916.html">Foam::polyBoundaryMesh</a></div><div class="ttdoc">Foam::polyBoundaryMesh. </div><div class="ttdef"><b>Definition:</b> <a href="a08640_source.html#l00060">polyBoundaryMesh.H:60</a></div></div>
<div class="ttc" id="a01404_html"><div class="ttname"><a href="a01404.html">Foam::Map&lt; label &gt;</a></div></div>
<div class="ttc" id="a10742_html_ac993e906cf2774ae77e666bc24e81733"><div class="ttname"><a href="a10742.html#ac993e906cf2774ae77e666bc24e81733">Foam::max</a></div><div class="ttdeci">dimensioned&lt; Type &gt; max(const dimensioned&lt; Type &gt; &amp;, const dimensioned&lt; Type &gt; &amp;)</div></div>
<div class="ttc" id="a05623_html"><div class="ttname"><a href="a05623.html">volFields.H</a></div></div>
<div class="ttc" id="a02797_html"><div class="ttname"><a href="a02797.html">Foam::Vector&lt; scalar &gt;</a></div></div>
<div class="ttc" id="a04581_html_a1f4c40f87f6a6e206dcec45518ac4afd"><div class="ttname"><a href="a04581.html#a1f4c40f87f6a6e206dcec45518ac4afd">includePatches</a></div><div class="ttdeci">labelHashSet includePatches</div><div class="ttdef"><b>Definition:</b> <a href="a04581_source.html#l00026">searchingEngine.H:26</a></div></div>
<div class="ttc" id="a00156_html"><div class="ttname"><a href="a00156.html">Foam::boundBox</a></div><div class="ttdoc">A bounding box defined in terms of the points at its extremities. </div><div class="ttdef"><b>Definition:</b> <a href="a08470_source.html#l00055">boundBox.H:55</a></div></div>
<div class="ttc" id="a00756_html"><div class="ttname"><a href="a00756.html">Foam::Field&lt; vector &gt;</a></div></div>
<div class="ttc" id="a01182_html_a20b9ac27bfc4eb7f88f7ae5771de6bf0a9e7b8f2e0979fecd1bbc84564f3d3891"><div class="ttname"><a href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a9e7b8f2e0979fecd1bbc84564f3d3891">Foam::IOobject::MUST_READ</a></div><div class="ttdef"><b>Definition:</b> <a href="a07759_source.html#l00108">IOobject.H:108</a></div></div>
<div class="ttc" id="a02772_html_afc74d89573de32a3032c916f8cdd1733"><div class="ttname"><a href="a02772.html#afc74d89573de32a3032c916f8cdd1733">Foam::UPstream::myProcNo</a></div><div class="ttdeci">static int myProcNo(const label communicator=0)</div><div class="ttdoc">Number of this process (starting from masterNo() = 0) </div><div class="ttdef"><b>Definition:</b> <a href="a07820_source.html#l00404">UPstream.H:404</a></div></div>
<div class="ttc" id="a02419_html"><div class="ttname"><a href="a02419.html">Foam::SquareMatrix&lt; scalar &gt;</a></div></div>
<div class="ttc" id="a02772_html_a36af549940a0aae3733774649594489f"><div class="ttname"><a href="a02772.html#a36af549940a0aae3733774649594489f">Foam::UPstream::master</a></div><div class="ttdeci">static bool master(const label communicator=0)</div><div class="ttdoc">Am I the master process. </div><div class="ttdef"><b>Definition:</b> <a href="a07820_source.html#l00398">UPstream.H:398</a></div></div>
<div class="ttc" id="a05618_html"><div class="ttname"><a href="a05618.html">surfaceFields.H</a></div><div class="ttdoc">Foam::surfaceFields. </div></div>
<div class="ttc" id="a02024_html"><div class="ttname"><a href="a02024.html">Foam::pTraits</a></div><div class="ttdoc">Traits class for primitives. </div><div class="ttdef"><b>Definition:</b> <a href="a08919_source.html#l00050">pTraits.H:50</a></div></div>
<div class="ttc" id="a05943_html"><div class="ttname"><a href="a05943.html">singleCellFvMesh.H</a></div></div>
<div class="ttc" id="a10742_html_a929da2a3fdcf3dacbbe0487d3a330dae"><div class="ttname"><a href="a10742.html#a929da2a3fdcf3dacbbe0487d3a330dae">Foam::mag</a></div><div class="ttdeci">dimensioned&lt; scalar &gt; mag(const dimensioned&lt; Type &gt; &amp;)</div></div>
<div class="ttc" id="a01922_html"><div class="ttname"><a href="a01922.html">Foam::polyMesh</a></div><div class="ttdoc">Mesh consisting of general polyhedral cells. </div><div class="ttdef"><b>Definition:</b> <a href="a08645_source.html#l00074">polyMesh.H:74</a></div></div>
<div class="ttc" id="a01922_html_a7774f6a2399cc071ff06ba6bb6d38b26"><div class="ttname"><a href="a01922.html#a7774f6a2399cc071ff06ba6bb6d38b26">Foam::polyMesh::bounds</a></div><div class="ttdeci">const boundBox &amp; bounds() const </div><div class="ttdoc">Return mesh bounding box. </div><div class="ttdef"><b>Definition:</b> <a href="a08645_source.html#l00427">polyMesh.H:427</a></div></div>
<div class="ttc" id="a01182_html_ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4"><div class="ttname"><a href="a01182.html#ade8fe914e1b32f96447fe9b2f8bbfc51a49d7e3f5888432d6048abf6cab3988d4">Foam::IOobject::NO_WRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="a07759_source.html#l00118">IOobject.H:118</a></div></div>
<div class="ttc" id="a00781_html_a8313eb64672be97529ce588ee8004061"><div class="ttname"><a href="a00781.html#a8313eb64672be97529ce588ee8004061">Foam::fileName::lessExt</a></div><div class="ttdeci">fileName lessExt() const </div><div class="ttdoc">Return file name without extension (part before last .) </div><div class="ttdef"><b>Definition:</b> <a href="a08967_source.html#l00268">fileName.C:268</a></div></div>
<div class="ttc" id="a07683_html_a1a02bffef961ee015f0e9b03d336c6a9"><div class="ttname"><a href="a07683.html#a1a02bffef961ee015f0e9b03d336c6a9">forAll</a></div><div class="ttdeci">#define forAll(list, i)</div><div class="ttdoc">Loop across all elements in list. </div><div class="ttdef"><b>Definition:</b> <a href="a07683_source.html#l00406">UList.H:406</a></div></div>
<div class="ttc" id="a10755_html_a2774afe1f96ab9c80af9ea7946f17bde"><div class="ttname"><a href="a10755.html#a2774afe1f96ab9c80af9ea7946f17bde">Foam::constant::physicoChemical::F</a></div><div class="ttdeci">const dimensionedScalar F</div><div class="ttdoc">Faraday constant: default SI units: [C/mol]. </div></div>
<div class="ttc" id="a02739_html"><div class="ttname"><a href="a02739.html">Foam::UIndirectList</a></div><div class="ttdoc">A List with indirect addressing. </div><div class="ttdef"><b>Definition:</b> <a href="a05801_source.html#l00106">fvMatrix.H:106</a></div></div>
<div class="ttc" id="a01922_html_aa81cc7eb673aa92f482daaa8685202ee"><div class="ttname"><a href="a01922.html#aa81cc7eb673aa92f482daaa8685202ee">Foam::polyMesh::geometricD</a></div><div class="ttdeci">const Vector&lt; label &gt; &amp; geometricD() const </div><div class="ttdoc">Return the vector of geometric directions in mesh. </div><div class="ttdef"><b>Definition:</b> <a href="a08644_source.html#l00784">polyMesh.C:784</a></div></div>
<div class="ttc" id="a10742_html_a08486711870135b87b73161e8f2fa4ed"><div class="ttname"><a href="a10742.html#a08486711870135b87b73161e8f2fa4ed">Foam::system</a></div><div class="ttdeci">int system(const std::string &amp;command)</div><div class="ttdoc">Execute the specified command. </div><div class="ttdef"><b>Definition:</b> <a href="a09079_source.html#l01186">POSIX.C:1186</a></div></div>
<div class="ttc" id="a01367_html_a8a5f6fa29bd4b500caf186f60245b384"><div class="ttname"><a href="a01367.html#a8a5f6fa29bd4b500caf186f60245b384">Foam::List::size</a></div><div class="ttdeci">void size(const label)</div><div class="ttdoc">Override size to be inconsistent with allocated storage. </div><div class="ttdef"><b>Definition:</b> <a href="a07653_source.html#l00076">ListI.H:76</a></div></div>
<div class="ttc" id="a04437_html_a78bcf340cde4f20cf12473945680d11a"><div class="ttname"><a href="a04437.html#a78bcf340cde4f20cf12473945680d11a">Qr</a></div><div class="ttdeci">volScalarField Qr(IOobject(                    &quot;Qr&quot;,                       runTime.timeName(),                       mesh,                       IOobject::READ_IF_PRESENT,                       IOobject::NO_WRITE       ), mesh, dimensionedScalar(&quot;Qr&quot;, dimMass/pow3(dimTime), 0.0))</div></div>
<div class="ttc" id="a10742_html_a277dc11c581d53826ab5090b08f3b17b"><div class="ttname"><a href="a10742.html#a277dc11c581d53826ab5090b08f3b17b">Foam::sqr</a></div><div class="ttdeci">dimensionedSymmTensor sqr(const dimensionedVector &amp;dv)</div><div class="ttdef"><b>Definition:</b> <a href="a07884_source.html#l00049">dimensionedSymmTensor.C:49</a></div></div>
<div class="ttc" id="a08212_html"><div class="ttname"><a href="a08212.html">addRegionOption.H</a></div></div>
<div class="ttc" id="a02022_html_afbdf64fb42cd760690d51a9a321792d9"><div class="ttname"><a href="a02022.html#afbdf64fb42cd760690d51a9a321792d9">Foam::Pstream::gatherList</a></div><div class="ttdeci">static void gatherList(const List&lt; commsStruct &gt; &amp;comms, List&lt; T &gt; &amp;Values, const int tag, const label comm)</div><div class="ttdoc">Gather data but keep individual values separate. </div><div class="ttdef"><b>Definition:</b> <a href="a07802_source.html#l00049">gatherScatterList.C:49</a></div></div>
<div class="ttc" id="a10742_html_a22e1fa85a26a2936be87e1582718e0cc"><div class="ttname"><a href="a10742.html#a22e1fa85a26a2936be87e1582718e0cc">Foam::dimless</a></div><div class="ttdeci">const dimensionSet dimless(0, 0, 0, 0, 0, 0, 0)</div><div class="ttdef"><b>Definition:</b> <a href="a07896_source.html#l00047">dimensionSets.H:47</a></div></div>
<div class="ttc" id="a07317_html"><div class="ttname"><a href="a07317.html">meshTools.H</a></div></div>
<div class="ttc" id="a05195_html"><div class="ttname"><a href="a05195.html">fixedValueFvPatchFields.H</a></div></div>
<div class="ttc" id="a01922_html_a8a91e85dc9825a7ae05720d4e7b48f2a"><div class="ttname"><a href="a01922.html#a8a91e85dc9825a7ae05720d4e7b48f2a">Foam::polyMesh::facesInstance</a></div><div class="ttdeci">const fileName &amp; facesInstance() const </div><div class="ttdoc">Return the current instance directory for faces. </div><div class="ttdef"><b>Definition:</b> <a href="a08644_source.html#l00778">polyMesh.C:778</a></div></div>
<div class="ttc" id="a02152_html_a6e5faa425b059eeb55cd904755791076"><div class="ttname"><a href="a02152.html#a6e5faa425b059eeb55cd904755791076">Foam::regIOobject::write</a></div><div class="ttdeci">virtual bool write() const </div><div class="ttdoc">Write using setting from DB. </div><div class="ttdef"><b>Definition:</b> <a href="a07852_source.html#l00125">regIOobjectWrite.C:125</a></div></div>
<div class="ttc" id="a02323_html"><div class="ttname"><a href="a02323.html">Foam::singleCellFvMesh</a></div><div class="ttdoc">fvMesh as subset of other mesh. Consists of one cell and all original bounday faces. Useful when manipulating boundary data. Single internal cell only needed to be able to manipulate in a standard way. </div><div class="ttdef"><b>Definition:</b> <a href="a05943_source.html#l00053">singleCellFvMesh.H:53</a></div></div>
<div class="ttc" id="a08220_html"><div class="ttname"><a href="a08220.html">createNamedMesh.H</a></div></div>
<div class="ttc" id="a01367_html"><div class="ttname"><a href="a01367.html">Foam::List&lt; label &gt;</a></div></div>
<div class="ttc" id="a08949_html"><div class="ttname"><a href="a08949.html">scalarListIOList.H</a></div></div>
<div class="ttc" id="a04582_html"><div class="ttname"><a href="a04582.html">shootRays.H</a></div></div>
<div class="ttc" id="a01922_html_a6b7f5ba89250dbd7a1c6c7860ab60fe3"><div class="ttname"><a href="a01922.html#a6b7f5ba89250dbd7a1c6c7860ab60fe3">Foam::polyMesh::boundaryMesh</a></div><div class="ttdeci">const polyBoundaryMesh &amp; boundaryMesh() const </div><div class="ttdoc">Return boundary mesh. </div><div class="ttdef"><b>Definition:</b> <a href="a08645_source.html#l00421">polyMesh.H:421</a></div></div>
<div class="ttc" id="a01182_html"><div class="ttname"><a href="a01182.html">Foam::IOobject</a></div><div class="ttdoc">IOobject defines the attributes of an object for which implicit objectRegistry management is supporte...</div><div class="ttdef"><b>Definition:</b> <a href="a07759_source.html#l00091">IOobject.H:91</a></div></div>
<div class="ttc" id="a01182_html_a20b9ac27bfc4eb7f88f7ae5771de6bf0a6be8dd810194d4022a4faec0a869d418"><div class="ttname"><a href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a6be8dd810194d4022a4faec0a869d418">Foam::IOobject::MUST_READ_IF_MODIFIED</a></div><div class="ttdef"><b>Definition:</b> <a href="a07759_source.html#l00109">IOobject.H:109</a></div></div>
<div class="ttc" id="a07952_html"><div class="ttname"><a href="a07952.html">DynamicField.H</a></div></div>
<div class="ttc" id="a00934_html_a7d52ac47ea25cc49744fc5658630a929"><div class="ttname"><a href="a00934.html#a7d52ac47ea25cc49744fc5658630a929">Foam::globalIndex::toGlobal</a></div><div class="ttdeci">label toGlobal(const label i) const </div><div class="ttdoc">From local to global. </div><div class="ttdef"><b>Definition:</b> <a href="a08610_source.html#l00082">globalIndexI.H:82</a></div></div>
<div class="ttc" id="a01406_html"><div class="ttname"><a href="a01406.html">Foam::mapDistribute</a></div><div class="ttdoc">Class containing processor-to-processor mapping information. </div><div class="ttdef"><b>Definition:</b> <a href="a08627_source.html#l00152">mapDistribute.H:152</a></div></div>
<div class="ttc" id="a07869_html"><div class="ttname"><a href="a07869.html">Time.H</a></div></div>
<div class="ttc" id="a10742_html_a2db8fe02a0d3909e9351bb4275b23ce4"><div class="ttname"><a href="a10742.html#a2db8fe02a0d3909e9351bb4275b23ce4">Foam::endl</a></div><div class="ttdeci">Ostream &amp; endl(Ostream &amp;os)</div><div class="ttdoc">Add newline and flush stream. </div><div class="ttdef"><b>Definition:</b> <a href="a07798_source.html#l00251">Ostream.H:251</a></div></div>
<div class="ttc" id="a00934_html_aa657795af2e35b1cd3ece418df75f4c0"><div class="ttname"><a href="a00934.html#aa657795af2e35b1cd3ece418df75f4c0">Foam::globalIndex::localSize</a></div><div class="ttdeci">label localSize() const </div><div class="ttdoc">My local size. </div><div class="ttdef"><b>Definition:</b> <a href="a08610_source.html#l00060">globalIndexI.H:60</a></div></div>
<div class="ttc" id="a00156_html_a2d9f25638302501b870cd5be87974010"><div class="ttname"><a href="a00156.html#a2d9f25638302501b870cd5be87974010">Foam::boundBox::span</a></div><div class="ttdeci">vector span() const </div><div class="ttdoc">The bounding box span (from minimum to maximum) </div><div class="ttdef"><b>Definition:</b> <a href="a08471_source.html#l00084">boundBoxI.H:84</a></div></div>
<div class="ttc" id="a00889_html_ad735de1fbd0f85c12ad0c37deb62d22c"><div class="ttname"><a href="a00889.html#ad735de1fbd0f85c12ad0c37deb62d22c">Foam::fvPatchField::patch</a></div><div class="ttdeci">const fvPatch &amp; patch() const </div><div class="ttdoc">Return patch. </div><div class="ttdef"><b>Definition:</b> <a href="a05528_source.html#l00335">fvPatchField.H:335</a></div></div>
<div class="ttc" id="a08769_html"><div class="ttname"><a href="a08769.html">uindirectPrimitivePatch.H</a></div></div>
<div class="ttc" id="a02966_html_ae21e2836509b0fa7f7cedf6493b11b09"><div class="ttname"><a href="a02966.html#ae21e2836509b0fa7f7cedf6493b11b09">forAllConstIter</a></div><div class="ttdeci">forAllConstIter(PtrDictionary&lt; phaseModel &gt;, mixture.phases(), phase)</div><div class="ttdef"><b>Definition:</b> <a href="a02966_source.html#l00029">pEqn.H:29</a></div></div>
<div class="ttc" id="a01695_html_a48fcf6de2789aff6b430b5fc1a05693f"><div class="ttname"><a href="a01695.html#a48fcf6de2789aff6b430b5fc1a05693f">Foam::objectRegistry::time</a></div><div class="ttdeci">const Time &amp; time() const </div><div class="ttdoc">Return time. </div><div class="ttdef"><b>Definition:</b> <a href="a07846_source.html#l00117">objectRegistry.H:117</a></div></div>
<div class="ttc" id="a01175_html"><div class="ttname"><a href="a01175.html">Foam::IOdictionary</a></div><div class="ttdoc">IOdictionary is derived from dictionary and IOobject to give the dictionary automatic IO functionalit...</div><div class="ttdef"><b>Definition:</b> <a href="a07771_source.html#l00053">IOdictionary.H:53</a></div></div>
<div class="ttc" id="a01805_html_a75b72488d2e82151b025744974919d5d"><div class="ttname"><a href="a01805.html#a75b72488d2e82151b025744974919d5d">Foam::patchIdentifier::name</a></div><div class="ttdeci">const word &amp; name() const </div><div class="ttdoc">Return name. </div><div class="ttdef"><b>Definition:</b> <a href="a08482_source.html#l00109">patchIdentifier.H:109</a></div></div>
<div class="ttc" id="a01922_html_a084ae534298576408f063a6b3b820959"><div class="ttname"><a href="a01922.html#a084ae534298576408f063a6b3b820959">Foam::polyMesh::points</a></div><div class="ttdeci">virtual const pointField &amp; points() const </div><div class="ttdoc">Return raw points. </div><div class="ttdef"><b>Definition:</b> <a href="a08644_source.html#l00979">polyMesh.C:979</a></div></div>
<div class="ttc" id="a00781_html"><div class="ttname"><a href="a00781.html">Foam::fileName</a></div><div class="ttdoc">A class for handling file names. </div><div class="ttdef"><b>Definition:</b> <a href="a08968_source.html#l00069">fileName.H:69</a></div></div>
<div class="ttc" id="a10754_html_a731b8788a4c01586c35266c7ca4fed04"><div class="ttname"><a href="a10754.html#a731b8788a4c01586c35266c7ca4fed04">Foam::constant::mathematical::pi</a></div><div class="ttdeci">const scalar pi(M_PI)</div></div>
<div class="ttc" id="a02475_html"><div class="ttname"><a href="a02475.html">Foam::sumOp</a></div><div class="ttdef"><b>Definition:</b> <a href="a08916_source.html#l00162">ops.H:162</a></div></div>
<div class="ttc" id="a01709_html"><div class="ttname"><a href="a01709.html">Foam::OFstream</a></div><div class="ttdoc">Output to file stream. </div><div class="ttdef"><b>Definition:</b> <a href="a07785_source.html#l00081">OFstream.H:81</a></div></div>
<div class="ttc" id="a00605_html"><div class="ttname"><a href="a00605.html">Foam::DynamicList</a></div><div class="ttdoc">A 1D vector of objects of type &lt;T&gt; that resizes itself as necessary to accept the new objects...</div><div class="ttdef"><b>Definition:</b> <a href="a07641_source.html#l00056">DynamicList.H:56</a></div></div>
<div class="ttc" id="a00934_html"><div class="ttname"><a href="a00934.html">Foam::globalIndex</a></div><div class="ttdoc">Calculates a unique integer (label so might not have enough room - 2G max) for processor + local inde...</div><div class="ttdef"><b>Definition:</b> <a href="a08609_source.html#l00063">globalIndex.H:63</a></div></div>
<div class="ttc" id="a01367_html_a4eb7a78f8b52136a8668d0e785dace04"><div class="ttname"><a href="a01367.html#a4eb7a78f8b52136a8668d0e785dace04">Foam::List::resize</a></div><div class="ttdeci">void resize(const label)</div><div class="ttdoc">Alias for setSize(const label) </div><div class="ttdef"><b>Definition:</b> <a href="a07653_source.html#l00050">ListI.H:50</a></div></div>
<div class="ttc" id="a00716_html_adf12beb51bcfe12477e066681cf0ac80"><div class="ttname"><a href="a00716.html#adf12beb51bcfe12477e066681cf0ac80">Foam::face::nTriangles</a></div><div class="ttdeci">label nTriangles() const </div><div class="ttdoc">Number of triangles after splitting. </div><div class="ttdef"><b>Definition:</b> <a href="a08545_source.html#l00130">faceI.H:130</a></div></div>
<div class="ttc" id="a10742_html_a7ffd6af4acc2eb9ba72ee296b5ecda23"><div class="ttname"><a href="a10742.html#a7ffd6af4acc2eb9ba72ee296b5ecda23">Foam::reduce</a></div><div class="ttdeci">void reduce(const List&lt; UPstream::commsStruct &gt; &amp;comms, T &amp;Value, const BinaryOp &amp;bop, const int tag, const label comm)</div><div class="ttdef"><b>Definition:</b> <a href="a07812_source.html#l00043">PstreamReduceOps.H:43</a></div></div>
<div class="ttc" id="a01182_html_a20b9ac27bfc4eb7f88f7ae5771de6bf0a2236347a9c1072b71703cbc5eccbad05"><div class="ttname"><a href="a01182.html#a20b9ac27bfc4eb7f88f7ae5771de6bf0a2236347a9c1072b71703cbc5eccbad05">Foam::IOobject::NO_READ</a></div><div class="ttdef"><b>Definition:</b> <a href="a07759_source.html#l00111">IOobject.H:111</a></div></div>
<div class="ttc" id="a10742_html_a3d8733143aad0e03b300186ab4bef137"><div class="ttname"><a href="a10742.html#a3d8733143aad0e03b300186ab4bef137">Foam::sum</a></div><div class="ttdeci">dimensioned&lt; Type &gt; sum(const DimensionedField&lt; Type, GeoMesh &gt; &amp;df)</div><div class="ttdef"><b>Definition:</b> <a href="a07902_source.html#l00333">DimensionedFieldFunctions.C:333</a></div></div>
<div class="ttc" id="a07228_html"><div class="ttname"><a href="a07228.html">cyclicAMIPolyPatch.H</a></div></div>
<div class="ttc" id="a04581_html"><div class="ttname"><a href="a04581.html">searchingEngine.H</a></div></div>
<div class="ttc" id="a01916_html_aa51573bc757d5d5bb058db0464886447"><div class="ttname"><a href="a01916.html#aa51573bc757d5d5bb058db0464886447">Foam::polyBoundaryMesh::mesh</a></div><div class="ttdeci">const polyMesh &amp; mesh() const </div><div class="ttdoc">Return the mesh reference. </div><div class="ttdef"><b>Definition:</b> <a href="a08640_source.html#l00140">polyBoundaryMesh.H:140</a></div></div>
<div class="ttc" id="a00888_html_a7d1e8acadb27bd2b4e61457d47b71b6f"><div class="ttname"><a href="a00888.html#a7d1e8acadb27bd2b4e61457d47b71b6f">Foam::fvPatch::index</a></div><div class="ttdeci">label index() const </div><div class="ttdoc">Return the index of this patch in the fvBoundaryMesh. </div><div class="ttdef"><b>Definition:</b> <a href="a05937_source.html#l00179">fvPatch.H:179</a></div></div>
<div class="ttc" id="a00985_html_a49f0753d9652681fc3a81f59951a0ad7"><div class="ttname"><a href="a00985.html#a49f0753d9652681fc3a81f59951a0ad7">Foam::HashSet::insert</a></div><div class="ttdeci">bool insert(const Key &amp;key)</div><div class="ttdoc">Insert a new entry. </div><div class="ttdef"><b>Definition:</b> <a href="a07587_source.html#l00116">HashSet.H:116</a></div></div>
<div class="ttc" id="a10742_html_a072b5cdfc288c7565684d29740185304"><div class="ttname"><a href="a10742.html#a072b5cdfc288c7565684d29740185304">Foam::dimensionedScalar</a></div><div class="ttdeci">dimensioned&lt; scalar &gt; dimensionedScalar</div><div class="ttdoc">Dimensioned scalar obtained from generic dimensioned type. </div><div class="ttdef"><b>Definition:</b> <a href="a07881_source.html#l00041">dimensionedScalarFwd.H:41</a></div></div>
<div class="ttc" id="a01974_html_a9be088de373a98524a153de7da0e92e8"><div class="ttname"><a href="a01974.html#a9be088de373a98524a153de7da0e92e8">Foam::primitiveMesh::nFaces</a></div><div class="ttdeci">label nFaces() const </div><div class="ttdef"><b>Definition:</b> <a href="a08747_source.html#l00088">primitiveMeshI.H:88</a></div></div>
<div class="ttc" id="a02022_html_a23c38ee54f04c9d53a327db9edbdb7f0"><div class="ttname"><a href="a02022.html#a23c38ee54f04c9d53a327db9edbdb7f0">Foam::Pstream::scatterList</a></div><div class="ttdeci">static void scatterList(const List&lt; commsStruct &gt; &amp;comms, List&lt; T &gt; &amp;Values, const int tag, const label comm)</div><div class="ttdoc">Scatter data. Reverse of gatherList. </div><div class="ttdef"><b>Definition:</b> <a href="a07802_source.html#l00205">gatherScatterList.C:205</a></div></div>
<div class="ttc" id="a10742_html_a5da5e7d950073675f3b3d26323a640db"><div class="ttname"><a href="a10742.html#a5da5e7d950073675f3b3d26323a640db">Foam::invertOneToMany</a></div><div class="ttdeci">labelListList invertOneToMany(const label len, const labelUList &amp;)</div><div class="ttdoc">Invert one-to-many map. Unmapped elements will be size 0. </div><div class="ttdef"><b>Definition:</b> <a href="a07658_source.html#l00067">ListOps.C:67</a></div></div>
<div class="ttc" id="a00716_html_acf1f421759f62e0e96e9bf3287fa67a8"><div class="ttname"><a href="a00716.html#acf1f421759f62e0e96e9bf3287fa67a8">Foam::face::triangles</a></div><div class="ttdeci">label triangles(const pointField &amp;points, label &amp;triI, faceList &amp;triFaces) const </div><div class="ttdoc">Split into triangles using existing points. </div><div class="ttdef"><b>Definition:</b> <a href="a08541_source.html#l00830">face.C:830</a></div></div>
<div class="ttc" id="a10742_html_a495791c4d9e97a9fb63adc1124e336dd"><div class="ttname"><a href="a10742.html#a495791c4d9e97a9fb63adc1124e336dd">Foam::renumber</a></div><div class="ttdeci">ListType renumber(const labelUList &amp;oldToNew, const ListType &amp;)</div><div class="ttdoc">Renumber the values (not the indices) of a list. </div><div class="ttdef"><b>Definition:</b> <a href="a07660_source.html#l00032">ListOpsTemplates.C:32</a></div></div>
<div class="ttc" id="a10742_html"><div class="ttname"><a href="a10742.html">Foam</a></div><div class="ttdoc">Namespace for OpenFOAM. </div><div class="ttdef"><b>Definition:</b> <a href="a04634_source.html#l00030">combustionModel.C:30</a></div></div>
<div class="ttc" id="a01367_html_aedb985ffeaf1bdbfeccc2a8730405703"><div class="ttname"><a href="a01367.html#aedb985ffeaf1bdbfeccc2a8730405703">Foam::List::setSize</a></div><div class="ttdeci">void setSize(const label)</div><div class="ttdoc">Reset size of List. </div><div class="ttdef"><b>Definition:</b> <a href="a07651_source.html#l00318">List.C:318</a></div></div>
<div class="ttc" id="a01182_html_a75b72488d2e82151b025744974919d5d"><div class="ttname"><a href="a01182.html#a75b72488d2e82151b025744974919d5d">Foam::IOobject::name</a></div><div class="ttdeci">const word &amp; name() const </div><div class="ttdoc">Return name. </div><div class="ttdef"><b>Definition:</b> <a href="a07759_source.html#l00260">IOobject.H:260</a></div></div>
<div class="ttc" id="a01178_html"><div class="ttname"><a href="a01178.html">Foam::IOList&lt; labelList &gt;</a></div></div>
<div class="ttc" id="a04735_html_a4c1de256df6b3d186a85745b3149394a"><div class="ttname"><a href="a04735.html#a4c1de256df6b3d186a85745b3149394a">mesh</a></div><div class="ttdeci">dynamicFvMesh &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="a04735_source.html#l00018">createDynamicFvMesh.H:18</a></div></div>
<div class="ttc" id="a05885_html"><div class="ttname"><a href="a05885.html">fvMesh.H</a></div></div>
<div class="ttc" id="a01254_html"><div class="ttname"><a href="a01254.html">Foam::labelledTri</a></div><div class="ttdoc">Triangle with additional region number. </div><div class="ttdef"><b>Definition:</b> <a href="a10473_source.html#l00049">labelledTri.H:49</a></div></div>
<div class="ttc" id="a02689_html_a40a43f76fd50b5f1cd1c242669a14406"><div class="ttname"><a href="a02689.html#a40a43f76fd50b5f1cd1c242669a14406">Foam::triSurface::patches</a></div><div class="ttdeci">const geometricSurfacePatchList &amp; patches() const </div><div class="ttdef"><b>Definition:</b> <a href="a10506_source.html#l00306">triSurface.H:306</a></div></div>
<div class="ttc" id="a10742_html_a1bc01f0470f765b8c1e9e7d09b5754bf"><div class="ttname"><a href="a10742.html#a1bc01f0470f765b8c1e9e7d09b5754bf">Foam::Pout</a></div><div class="ttdeci">prefixOSstream Pout(cout,&quot;Pout&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="a07789_source.html#l00053">IOstreams.H:53</a></div></div>
<div class="ttc" id="a00889_html"><div class="ttname"><a href="a00889.html">Foam::fvPatchField</a></div><div class="ttdoc">Abstract base class with a fat-interface to all derived classes covering all possible ways in which t...</div><div class="ttdef"><b>Definition:</b> <a href="a05528_source.html#l00065">fvPatchField.H:65</a></div></div>
<div class="ttc" id="a01977_html_a1f42f31bcf706357682dcf097255b544"><div class="ttname"><a href="a01977.html#a1f42f31bcf706357682dcf097255b544">Foam::PrimitivePatch::points</a></div><div class="ttdeci">const Field&lt; PointType &gt; &amp; points() const </div><div class="ttdoc">Return reference to global points. </div><div class="ttdef"><b>Definition:</b> <a href="a08757_source.html#l00284">PrimitivePatch.H:284</a></div></div>
<div class="ttc" id="a01922_html_a061a278c425f5eaa95a0a5ee973a332f"><div class="ttname"><a href="a01922.html#a061a278c425f5eaa95a0a5ee973a332f">Foam::polyMesh::nSolutionD</a></div><div class="ttdeci">label nSolutionD() const </div><div class="ttdoc">Return the number of valid solved-for dimensions in the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="a08644_source.html#l00812">polyMesh.C:812</a></div></div>
<div class="ttc" id="a02038_html_a723361dc2020160f5492e8fe2d09fa44"><div class="ttname"><a href="a02038.html#a723361dc2020160f5492e8fe2d09fa44">Foam::PtrList::size</a></div><div class="ttdeci">label size() const </div><div class="ttdoc">Return the number of elements in the PtrList. </div><div class="ttdef"><b>Definition:</b> <a href="a07670_source.html#l00032">PtrListI.H:32</a></div></div>
<div class="ttc" id="a01940_html"><div class="ttname"><a href="a01940.html">Foam::polyPatch</a></div><div class="ttdoc">A patch is a list of labels that address the faces in the global face list. </div><div class="ttdef"><b>Definition:</b> <a href="a08686_source.html#l00066">polyPatch.H:66</a></div></div>
<div class="ttc" id="a08227_html"><div class="ttname"><a href="a08227.html">setRootCase.H</a></div></div>
<div class="ttc" id="a08627_html"><div class="ttname"><a href="a08627.html">mapDistribute.H</a></div></div>
<div class="ttc" id="a00716_html"><div class="ttname"><a href="a00716.html">Foam::face</a></div><div class="ttdoc">A face is a list of labels corresponding to mesh vertices. </div><div class="ttdef"><b>Definition:</b> <a href="a08542_source.html#l00075">face.H:75</a></div></div>
<div class="ttc" id="a02797_html_ac3b79445511a1e3a6443b59ac93c394a"><div class="ttname"><a href="a02797.html#ac3b79445511a1e3a6443b59ac93c394a">Foam::Vector&lt; scalar &gt;::zero</a></div><div class="ttdeci">static const Vector zero</div><div class="ttdef"><b>Definition:</b> <a href="a09051_source.html#l00080">Vector.H:80</a></div></div>
<div class="ttc" id="a01974_html_aa1eec60bd258a70018b8ffda0dced7bb"><div class="ttname"><a href="a01974.html#aa1eec60bd258a70018b8ffda0dced7bb">Foam::primitiveMesh::nInternalFaces</a></div><div class="ttdeci">label nInternalFaces() const </div><div class="ttdef"><b>Definition:</b> <a href="a08747_source.html#l00082">primitiveMeshI.H:82</a></div></div>
<div class="ttc" id="a09425_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="a09425.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="a09425_source.html#l00054">postCalc.C:54</a></div></div>
<div class="ttc" id="a08442_html"><div class="ttname"><a href="a08442.html">scalarMatrices.H</a></div></div>
<div class="ttc" id="a02472_html"><div class="ttname"><a href="a02472.html">Foam::SubList&lt; point &gt;</a></div></div>
<div class="ttc" id="a02772_html_aada0e04d8127eda8ee95be0772754a4f"><div class="ttname"><a href="a02772.html#aada0e04d8127eda8ee95be0772754a4f">Foam::UPstream::nProcs</a></div><div class="ttdeci">static label nProcs(const label communicator=0)</div><div class="ttdoc">Number of processes in parallel run. </div><div class="ttdef"><b>Definition:</b> <a href="a07820_source.html#l00386">UPstream.H:386</a></div></div>
<div class="ttc" id="a10797_html_afd76c6ccc8ee4a5957f0232218167c17"><div class="ttname"><a href="a10797.html#afd76c6ccc8ee4a5957f0232218167c17">Foam::meshTools::writeOBJ</a></div><div class="ttdeci">void writeOBJ(Ostream &amp;os, const point &amp;pt)</div><div class="ttdoc">Write obj representation of point. </div><div class="ttdef"><b>Definition:</b> <a href="a07316_source.html#l00204">meshTools.C:204</a></div></div>
<div class="ttc" id="a00924_html_a3c6c1a789b48ea0c5e8bff64f9c14f2d"><div class="ttname"><a href="a00924.html#a3c6c1a789b48ea0c5e8bff64f9c14f2d">Foam::GeometricField::boundaryField</a></div><div class="ttdeci">GeometricBoundaryField &amp; boundaryField()</div><div class="ttdoc">Return reference to GeometricBoundaryField. </div><div class="ttdef"><b>Definition:</b> <a href="a08033_source.html#l00715">GeometricField.C:715</a></div></div>
<div class="ttc" id="a00985_html"><div class="ttname"><a href="a00985.html">Foam::HashSet&lt; label, Hash&lt; label &gt; &gt;</a></div></div>
<div class="ttc" id="a02689_html"><div class="ttname"><a href="a02689.html">Foam::triSurface</a></div><div class="ttdoc">Triangulated surface description with patch information. </div><div class="ttdef"><b>Definition:</b> <a href="a10506_source.html#l00057">triSurface.H:57</a></div></div>
<div class="ttc" id="a10742_html_a22f45a3cb4f074e609f58ebaeef0ecf9"><div class="ttname"><a href="a10742.html#a22f45a3cb4f074e609f58ebaeef0ecf9">Foam::label</a></div><div class="ttdeci">intWM_LABEL_SIZE_t label</div><div class="ttdoc">A label is an int32_t or int64_t as specified by the pre-processor macro WM_LABEL_SIZE. </div><div class="ttdef"><b>Definition:</b> <a href="a08892_source.html#l00059">label.H:59</a></div></div>
<div class="ttc" id="a01977_html"><div class="ttname"><a href="a01977.html">Foam::PrimitivePatch</a></div><div class="ttdoc">A list of faces which address into the list of points. </div><div class="ttdef"><b>Definition:</b> <a href="a08757_source.html#l00087">PrimitivePatch.H:87</a></div></div>
<div class="ttc" id="a01741_html_ab27acd1d200f0d245337451aa2f31517"><div class="ttname"><a href="a01741.html#ab27acd1d200f0d245337451aa2f31517">Foam::OSstream::name</a></div><div class="ttdeci">virtual const fileName &amp; name() const </div><div class="ttdoc">Return the name of the stream. </div><div class="ttdef"><b>Definition:</b> <a href="a07826_source.html#l00088">OSstream.H:88</a></div></div>
<div class="ttc" id="a10742_html_ae53117a9770efe95d2d01bb5cc2c99ef"><div class="ttname"><a href="a10742.html#ae53117a9770efe95d2d01bb5cc2c99ef">Foam::nl</a></div><div class="ttdeci">static const char nl</div><div class="ttdef"><b>Definition:</b> <a href="a07798_source.html#l00260">Ostream.H:260</a></div></div>
<div class="ttc" id="a02616_html_a5ae6a110de1b22323e19a46943c7f0c1"><div class="ttname"><a href="a02616.html#a5ae6a110de1b22323e19a46943c7f0c1">Foam::Time::timeName</a></div><div class="ttdeci">static word timeName(const scalar, const int precision=precision_)</div><div class="ttdoc">Return time name of given scalar time. </div><div class="ttdef"><b>Definition:</b> <a href="a07868_source.html#l00741">Time.C:741</a></div></div>
</div><!-- fragment --></div><!-- contents -->
  <!-- end of doxygen-generated content -->
  </div> <!-- main -->
  <div class="footer">
    <p>
      Copyright&nbsp;&copy;&nbsp;2011-2013&nbsp;
      <a href="http://www.openfoam.org/about">OpenFOAM Foundation</a>
      |
      OPENFOAM&reg; is a registered
      <a href="http://www.openfoam.com/legal/trademark-policy.php">trademarks
      </a> of OpenCFD Ltd.
    </p>
    <p class="credits">
      Based on design by
      <a target="new" href="http://1234.info">1234.info</a>
      |
      Content generated by
      <a target="new" href="http://www.doxygen.org">doxygen</a>
    </p>
  </div>  <!-- footer -->
</div>  <!-- page-container -->
</body>
</html>
